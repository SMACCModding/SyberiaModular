<ul class="nav nav-tabs" id="myTab" role="tablist">
    <li class="nav-item">
        <a class="nav-link active" id="players-tab" data-toggle="tab" href="#players" role="tab" aria-controls="players" aria-selected="true">Players</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" id="settings-tab" data-toggle="tab" href="#settings" role="tab" aria-controls="settings" aria-selected="false">Settings</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" id="admins-tab" data-toggle="tab" href="#admins" role="tab" aria-controls="admins" aria-selected="false">Admins</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" id="default-groups-tab" data-toggle="tab" href="#defaultGroup" role="tab" aria-controls="defaultGroup" aria-selected="false">Respawn settings</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" id="factions-tab" data-toggle="tab" href="#factions" role="tab" aria-controls="factions" aria-selected="false">Factions</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" id="loadouts-tab" data-toggle="tab" href="#loadouts" role="tab" aria-controls="loadouts" aria-selected="false">Loadouts</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" id="traders-tab" data-toggle="tab" href="#traders" role="tab" aria-controls="traders" aria-selected="false">Barter traders</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" id="zones-tab" data-toggle="tab" href="#zones" role="tab" aria-controls="zones" aria-selected="false">Zones</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" id="crafting-tab" data-toggle="tab" href="#crafting" role="tab" aria-controls="crafting" aria-selected="false">Crafting</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" id="variables-tab" data-toggle="tab" href="#variables" role="tab" aria-controls="variables" aria-selected="false">Variables</a>
    </li>
</ul>
<div class="tab-content" style="margin-top: 30px; margin-left: 50px; margin-right: 50px; margin-bottom: 30px">
    <div class="tab-pane active" id="players" role="tabpanel" aria-labelledby="players-tab">
        <div id="playersOfflineContent">
            <div class="container">
                <div class="row">
                    <div class="col text-center">
                        <div class="alert alert-danger" role="alert" style="visibility: hidden" id="alertMessagePlayersOffline"></div>
                        <button type="button" class="btn btn-primary btn-md" onclick="loadPlayersListOffline(this)">Load players list</button>
                    </div>
                </div>
            </div>
        </div>
        <script>
            function loadPlayersListOffline(button) {
                $(button).prop("disabled", true);
                $('#playersOfflineContent').load("/playersOffline", userData, function (response, status, xhr) {
                    if (status == "success") {
                        console.log('Players list successfully loaded.');
                    }
                    else {
                        $(button).prop("disabled", false);
                        $("#alertMessagePlayersOffline").css('visibility', 'visible');
                        if (xhr.status == 0) {
                            $("#alertMessagePlayersOffline").html('Service is unreachable. Please check is server running or internet connection.');
                        }
                        else {
                            $("#alertMessagePlayersOffline").html('Service is temporarily unavailable.');
                        }
                    }
                });
            }
        </script>
    </div>
    <div class="tab-pane" id="settings" role="tabpanel" aria-labelledby="settings-tab">
        <div id="settingsForm">
            <h3>Main settings:</h3>
            <div class="form-group row">
                <label for="inputStartSoulsCount" class="col-sm-2 col-form-label">Starting souls count:</label>
                <div class="col-sm-10">
                    <input type="number" min="0" max="10000" step="1" pattern="^[\d]+$" class="form-control" onchange="validateNumberInput(this)"
                           id="inputStartSoulsCount" mapping="m_mainConfig.m_startSoulsCount" value="${m_mainConfig.m_startSoulsCount}" required>
                    <p><em>The number of souls that the player receives when creating a character.</em></p>
                </div>
            </div>
            <div class="form-group row">
                <label for="inputRespawnSoulsPrice" class="col-sm-2 col-form-label">Respawn souls price:</label>
                <div class="col-sm-10">
                    <input type="number" min="0" max="10000" step="1" pattern="^[\d]+$" class="form-control" onchange="validateNumberInput(this)"
                           id="inputRespawnSoulsPrice" mapping="m_mainConfig.m_respawnSoulsPrice" value="${m_mainConfig.m_respawnSoulsPrice}" required>
                    <p><em>The number of souls that the player loses when the character dies and are needed for respawn.</em></p>
                </div>
            </div>
            <div class="form-group row">
                <label for="inputNewChatPoints" class="col-sm-2 col-form-label">Starting skill points:</label>
                <div class="col-sm-10">
                    <input type="number" min="0" max="1000" step="1" pattern="^[\d]+$" class="form-control" onchange="validateNumberInput(this)"
                           id="inputNewChatPoints" mapping="m_mainConfig.m_newchar_points" value="${m_mainConfig.m_newchar_points}" required>
                    <p><em>The number of skill points that the player will get when creating a new character.</em></p>
                </div>
            </div>
            <div class="form-group row">
                <label for="inputRoleplayMode" class="col-sm-2 col-form-label">Disable character deletion:</label>
                <div class="col-sm-10">
                    <input class="form-check-input" type="checkbox" id="inputRoleplayMode" mapping="m_mainConfig.m_roleplay_mode">
                    <script>$('#inputRoleplayMode').prop('checked', '${m_mainConfig.m_roleplay_mode}' == '1');</script>
                    <p><em>When this option is enabled, players will not be able to delete their character on the respawn screen.</em></p>
                </div>
            </div>
            <div class="form-group row">
                <label for="inputStartMedicKit" class="col-sm-2 col-form-label">Start medic kit:</label>
                <div class="col-sm-10">
                    <textarea class="form-control" id="inputStartMedicKit" mapping="m_mainConfig.m_startMedicKit">${m_mainConfig.m_startMedicKit}</textarea>
                    <p><em>A set of starting equipment that the player can choose on respawn when character has reached level 100 of medicine skill and activated the corresponding perk. Each new item's classname must be specified on a new line. To set the amount in the stack and the damage state, you can use the rules from the loadouts category.</em></p>
                </div>
            </div>
            <div class="form-group row">
                <label for="inputStartStealthKit" class="col-sm-2 col-form-label">Start stealth kit:</label>
                <div class="col-sm-10">
                    <textarea class="form-control" id="inputStartStealthKit" mapping="m_mainConfig.m_startStealthKit">${m_mainConfig.m_startStealthKit}</textarea>
                    <p><em>A set of starting equipment that the player can choose on respawn when character has reached level 100 of stealth skill and activated the corresponding perk. Each new item's classname must be specified on a new line. To set the amount in the stack and the damage state, you can use the rules from the loadouts category.</em></p>
                </div>
            </div>
            <div class="form-group row">
                <label for="inputStartSurvivorKit" class="col-sm-2 col-form-label">Start survival kit:</label>
                <div class="col-sm-10">
                    <textarea class="form-control" id="inputStartSurvivorKit" mapping="m_mainConfig.m_startSurvivorKit">${m_mainConfig.m_startSurvivorKit}</textarea>
                    <p><em>A set of starting equipment that the player can choose on respawn when character has reached level 100 of survival skill and activated the corresponding perk. Each new item's classname must be specified on a new line. To set the amount in the stack and the damage state, you can use the rules from the loadouts category.</em></p>
                </div>
            </div>
            <div class="form-group row">
                <label for="inputCheckIdentityMode" class="col-sm-2 col-form-label">Check identity mode:</label>
                <div class="col-sm-10">
                    <select class="custom-select" id="inputCheckIdentityMode" mapping="m_clientConfig.m_checkIdentityMode">
                        <option value="0">Disabled</option>
                        <option value="1">Always (When face not hidden by mask)</option>
                        <option value="2">Dead bodies only</option>
                    </select>
                    <script>
                        $('#inputCheckIdentityMode').find('option[value="${m_clientConfig.m_checkIdentityMode}"]').prop('selected', true);
                    </script>
                    <p><em>Sets the rules under which players can look at each other player's name.</em></p>
                </div>
            </div>
            <div class="form-group row">
                <label for="inputOperateVisceraHimself" class="col-sm-2 col-form-label">Allow surgery on yourself:</label>
                <div class="col-sm-10">
                    <input class="form-check-input" type="checkbox" id="inputOperateVisceraHimself" mapping="m_clientConfig.m_operateVisceraHimself">
                    <script>$('#inputOperateVisceraHimself').prop('checked', '${m_clientConfig.m_operateVisceraHimself}' == '1');</script>
                    <p><em>Determines whether the player can use the surgical kit to perform surgery on himself without the help of other players.</em></p>
                </div>
            </div>
            <br>
            <h3>PDA settings</h3>
            <div class="form-group row">
                <label for="inputPdaEnableGlobalChat" class="col-sm-2 col-form-label">Enable global channel:</label>
                <div class="col-sm-10">
                    <input class="form-check-input" type="checkbox" id="inputPdaEnableGlobalChat" mapping="m_pdaConfig.m_enableGlobalChat">
                    <script>$('#inputPdaEnableGlobalChat').prop('checked', '${m_pdaConfig.m_enableGlobalChat}' == '1');</script>
                    <p><em>This option adds to the list of conversations in the PDA a global channel for communication between players who have PDAs.</em></p>
                </div>
            </div>
            <div class="form-group row">
                <label for="inputPdaEnableMapPage" class="col-sm-2 col-form-label">Enable GPS tab:</label>
                <div class="col-sm-10">
                    <input class="form-check-input" type="checkbox" id="inputPdaEnableMapPage" mapping="m_pdaConfig.m_enableMapPage">
                    <script>$('#inputPdaEnableMapPage').prop('checked', '${m_pdaConfig.m_enableMapPage}' == '1');</script>
                    <p><em>This option enables a PDA tab with a map and the exact location of the player on it.</em></p>
                </div>
            </div>
            <div class="form-group row">
                <label for="inputPdaServerInstanceName" class="col-sm-2 col-form-label">Communication satellite ID:</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="inputPdaServerInstanceName" mapping="m_pdaConfig.m_serverInstanceName" value="${m_pdaConfig.m_serverInstanceName}" required>
                    <p><em>Sets the name of the communication satellite for the PDA. If you want the list of contacts and conversations to be shared between several DeyZ servers, use the same satellite ID. Do not change this value unnecessarily.</em></p>
                </div>
            </div>
            <br>
            <h3>Skill settings</h3>
            <div class="form-group row">
                <label for="inputSkillLevelSize" class="col-sm-2 col-form-label">Base skill experience amount:</label>
                <div class="col-sm-10">
                    <input type="number" min="10" max="1000000" step="1" pattern="^[\d]+$" class="form-control" onchange="validateNumberInput(this)"
                           id="inputSkillLevelSize" mapping="m_clientConfig.m_skillLevelSize" value="${m_clientConfig.m_skillLevelSize}" required>
                    <p><em>Determines the amount of experience a player needs at the first level of any skill.</em></p>
                </div>
            </div>
            <div class="form-group row">
                <label for="inputSkillLevelSize" class="col-sm-2 col-form-label">Additional skill experience amount per level:</label>
                <div class="col-sm-10">
                    <input type="number" min="10" max="100000" step="1" pattern="^[\d]+$" class="form-control" onchange="validateNumberInput(this)"
                           id="inputSkillLevelSize" mapping="m_clientConfig.m_skillLevelModifier" value="${m_clientConfig.m_skillLevelModifier}" required>
                    <p><em>The amount of experience added to the base with each new skill level.</em></p>
                </div>
            </div>
            <br>
            <h5>Experience gain modifiers for each skill</h5>
            <p><em>The experience multiplier defines how quickly the player gains experience in the game for each skill. The default value is 1. If you want the player to get 2 times more experience, set this value to 2. And vice versa, if you want to slow down the process of gaining experience, set the value less than one (0.5 for example)</em></p>
            <p><em>The decrease in the skill level at death determines how much experience the player will lose for each skill when the character dies. A value of 1 indicates that the player will lose 1 skill level upon death. With a value of 0.5, the player will only lose half of the level. If you want to disable the loss of experience by players on death, specify 0 as the value.</em></p>
            <div class="form-group row">
                <table class="table">
                    <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">Experience multiplier</th>
                            <th scope="col">Decrease level on death</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th scope="row">Immunity</th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[0].m_mod" value="${m_mainConfig.m_skillModifiers[0].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[0].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[0].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                        <tr>
                            <th scope="row">Athletics</th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[1].m_mod" value="${m_mainConfig.m_skillModifiers[1].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[1].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[1].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                        <tr>
                            <th scope="row">Strength</th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[2].m_mod" value="${m_mainConfig.m_skillModifiers[2].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[2].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[2].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                        <tr>
                            <th scope="row">Medicine</th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[3].m_mod" value="${m_mainConfig.m_skillModifiers[3].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[3].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[3].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                        <tr>
                            <th scope="row">Stealth</th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[4].m_mod" value="${m_mainConfig.m_skillModifiers[4].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[4].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[4].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                        <tr>
                            <th scope="row">Survival</th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[5].m_mod" value="${m_mainConfig.m_skillModifiers[5].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[5].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[5].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                        <tr>
                            <th scope="row">Farming <i>(Not Implemented)</i></th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[6].m_mod" value="${m_mainConfig.m_skillModifiers[6].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[6].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[6].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                        <tr>
                            <th scope="row">Hunting</th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[7].m_mod" value="${m_mainConfig.m_skillModifiers[7].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[7].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[7].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                        <tr>
                            <th scope="row">Fishing <i>(Not Implemented)</i></th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[8].m_mod" value="${m_mainConfig.m_skillModifiers[8].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[8].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[8].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                        <tr>
                            <th scope="row">Mechanics <i>(Not Implemented)</i></th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[9].m_mod" value="${m_mainConfig.m_skillModifiers[9].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[9].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[9].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                        <tr>
                            <th scope="row">Electronics <i>(Not Implemented)</i></th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[10].m_mod" value="${m_mainConfig.m_skillModifiers[10].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[10].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[10].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                        <tr>
                            <th scope="row">Carpentry <i>(Not Implemented)</i></th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[11].m_mod" value="${m_mainConfig.m_skillModifiers[11].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[11].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[11].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                        <tr>
                            <th scope="row">Metalworking <i>(Not Implemented)</i></th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[12].m_mod" value="${m_mainConfig.m_skillModifiers[12].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[12].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[12].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                        <tr>
                            <th scope="row">Building <i>(Not Implemented)</i></th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[13].m_mod" value="${m_mainConfig.m_skillModifiers[13].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[13].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[13].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                        <tr>
                            <th scope="row">Firearms <i>(Not Implemented)</i></th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[14].m_mod" value="${m_mainConfig.m_skillModifiers[14].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[14].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[14].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                        <tr>
                            <th scope="row">Lockpicking <i>(Not Implemented)</i></th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[15].m_mod" value="${m_mainConfig.m_skillModifiers[15].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[15].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[15].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                        <tr>
                            <th scope="row">Herbalism <i>(Not Implemented)</i></th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[16].m_mod" value="${m_mainConfig.m_skillModifiers[16].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[16].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[16].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                        <tr>
                            <th scope="row">Seamstess <i>(Not Implemented)</i></th>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[17].m_mod" value="${m_mainConfig.m_skillModifiers[17].m_mod}" onchange="validateNumberInput(this)" required></td>
                            <td><input type="number" min="0" max="1000" step="any" class="form-control" mapping="m_mainConfig.m_skillModifiers[17].m_decreaseOnDeath" value="${m_mainConfig.m_skillModifiers[17].m_decreaseOnDeath}" onchange="validateNumberInput(this)" required></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="alert" role="alert" style="visibility: hidden" id="alertMessageSettings"></div>
            <button type="button" class="btn btn-primary btn-lg" wid onclick="savePageSettings(readPageValues('#settingsForm'), '#alertMessageSettings')">Save</button>
        </div>
    </div>
    <div class="tab-pane" id="admins" role="tabpanel" aria-labelledby="admins-tab">
        <div id="adminsForm">
            <h3>Admin tool settings:</h3>
            <p><em>You can open the admin tool in the game with the keyboard shortcut 'Alt' + '~'. Teleport to cursor 'Alt' + 'T'.</em></p>
            <div class="form-group row">
                <label for="inputAdminsList" class="col-sm-2 col-form-label">Admin UIDs:</label>
                <div class="col-sm-10">
                    <textarea class="form-control" id="inputAdminsList" mapping="m_adminToolOptions.m_adminUids">${m_adminToolOptions.m_adminUids}</textarea>
                    <p><em>Specify UID's or SteamID64's to add new admins. Every UID should be on a new line.</em></p>
                </div>
            </div>
            <div class="alert" role="alert" style="visibility: hidden" id="alertMessageAdmins"></div>
            <button type="button" class="btn btn-primary btn-lg" wid onclick="savePageSettings(readPageValues('#adminsForm'), '#alertMessageAdmins')">Save</button>
        </div>
    </div>
    <div class="tab-pane" id="defaultGroup" role="tabpanel" aria-labelledby="default-groups-tab">
        <h3>Respawn settings:</h3>
        <p><em>Default respawn configuration of starting equipment and spawn points for all players.</em></p>
        <br>
        <div class="form-group row">
            <label for="inputGroupSpawnpointsSelect" class="col-sm-2 col-form-label">Respawn locations:</label>
            <div class="col-sm-10 input-group-btn">
                <div class="input-group-prepend">
                    <button class="btn btn-outline-secondary" type="button" id="inputGroupSpawnpointNew">Add</button>
                    <select class="form-control custom-select" id="inputGroupSpawnpointsSelect"></select>
                    <button class="btn btn-outline-secondary" type="button" id="inputGroupSpawnpointDelete">Remove</button>
                </div>
                <div class="row">
                    <div class="col col-sm-1">
                    </div>
                    <div class="col col-sm-11">
                        <label for="inputGroupSpawnpointsName">Name:</label>
                        <input type="text" class="form-control" id="inputGroupSpawnpointsName" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col col-sm-1">
                    </div>
                    <div class="col col-sm-11">
                        <label for="inputGroupSpawnpointsPositionsSelection">Points:</label>
                        <div class="input-group-prepend">
                            <button class="btn btn-outline-secondary" type="button" id="inputGroupSpawnpointPositionNew">Add</button>
                            <select class="form-control custom-select" id="inputGroupSpawnpointsPositionsSelection"></select>
                            <button class="btn btn-outline-secondary" type="button" id="inputGroupSpawnpointPositionDelete">Remove</button>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col col-sm-2">
                    </div>
                    <div class="col col-sm-6">
                        <label for="inputGroupSpawnpointsPosition">Position:</label>
                        <input type="text" class="form-control" onchange="validateVectorInput(this)" id="inputGroupSpawnpointsPosition" required>
                    </div>
                    <div class="col col-sm-4">
                        <label for="inputGroupSpawnpointsRadius">Radius:</label>
                        <input type="number" min="1" max="100" step="any" class="form-control" id="inputGroupSpawnpointsRadius" onchange="validateNumberInput(this)" required>
                    </div>
                </div>
                <br />
                <p>
                    <em>Respawn locations allow the player to select a specific spawn location while respawning.</em><br />
                    <em>The name of the location for the respawn will be displayed in the list on the player's respawn screen.</em><br />
                    <em>The points determine the list of possible points of the player's appearance in the given location. The selection of a point from a subset of all available ones occurs randomly.</em><br />
                    <em>The position is set with 3 numbers on the XYZ axes separated by spaces. You can find out the coordinates of the player's current position in the game using the admin tools.</em><br />
                    <em>The radius allows you to set a circle relative to the position inside which the player can respawn. Please do not set the radius too high to prevent the player from getting stuck in objects.</em>
                </p>
            </div>
        </div>
        <br>
        <br>
        <h5>Clothing & Weapons presets:</h5>
        <p><em>A list of items available for the player to select upon respawn from the list for each body part or weapon slot. The classname of each item should start on a new line. You can also set the amount and percent of damage to the item if necessary using additional parameters.</em></p>
        <div class="form-group row">
            <label for="inputGroupGearBody" class="col-sm-2 col-form-label">Body clothing:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputGroupGearBody"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">Hoodie_Black; H0.5</span><em> - Black hoodie with 50% health (Damaged)</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputGroupGearPants" class="col-sm-2 col-form-label">Pants:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputGroupGearPants"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">Jeans_Blue</span><em> - Blue jeans (Pristine)</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputGroupGearShoes" class="col-sm-2 col-form-label">Shoes:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputGroupGearShoes"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">AthleticShoes_Black; H0.8</span><em> - Shoes with 80% health</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputGroupGearHeadgears" class="col-sm-2 col-form-label">Headgears:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputGroupGearHeadgears"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">BoonieHat_Olive</span><em> - Boonie Hat (Pristine)</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputGroupGearMasks" class="col-sm-2 col-form-label">Masks:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputGroupGearMasks"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">GasMask; @GasMask_Filter</span><em> - Gas mask with filter in attachment.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputGroupGearGloves" class="col-sm-2 col-form-label">Gloves:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputGroupGearGloves"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">OMNOGloves_Gray</span></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputGroupGearVests" class="col-sm-2 col-form-label">Vests:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputGroupGearVests"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">PlateCarrierVest; H0.5; @PlateCarrierPouches,PlateCarrierHolster</span><em> - Damaged plate carrier with pouches and holster in attachments.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputGroupGearBackpacks" class="col-sm-2 col-form-label">Backpacks:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputGroupGearBackpacks"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">DryBag_Orange</span></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputGroupGearWeapons" class="col-sm-2 col-form-label">Weapons:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputGroupGearWeapons"></textarea>
                <p><em>Examples:</em> <span class="badge badge-info">M4A1; @M4_CarryHandleOptic,M4_CQBBttstck,M4_RISHndgrd; &Mag_STANAGCoupled_30Rnd; H0.5</span><em> - M4A1 with attachments or </em><span class="badge badge-info">Izh43Shotgun; &Ammo_12gaPellets</span><em> - double-barreled shotgun with ammo.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputGroupGearItems" class="col-sm-2 col-form-label">Item sets:</label>
            <div class="col-sm-10 input-group-btn">
                <div class="input-group-prepend">
                    <button class="btn btn-outline-secondary" type="button" id="inputGroupGearItemsNew">Add</button>
                    <select class="form-control custom-select" id="inputGroupGearItems"></select>
                    <button class="btn btn-outline-secondary" type="button" id="inputGroupGearItemsDelete">Remove</button>
                </div>
                <p><em>Determines the sets of items that the player can choose upon respawn. Each set can contain several items at the same time. The name of the set will be displayed to the player when choosing a starting equipment.</em></p>
                <div class="row">
                    <div class="col col-sm-1">
                    </div>
                    <div class="col col-sm-11">
                        <label for="inputGroupGearItemsName">Name:</label>
                        <input type="text" class="form-control" id="inputGroupGearItemsName" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col col-sm-1">
                    </div>
                    <div class="col col-sm-11">
                        <label for="inputGroupGearItemsList">Items:</label>
                        <textarea class="form-control" id="inputGroupGearItemsList"></textarea>
                    </div>
                </div>
            </div>
        </div>
        <div class="alert" role="alert" style="visibility: hidden" id="alertMessageGroups"></div>
        <button type="button" class="btn btn-primary btn-lg" wid onclick="savePageSettings(getGroupsDataObject(), '#alertMessageGroups')">Save</button>
        <script>
            var currentGroupSpawnpointId = -1;
            var currentGroupSpawnpointPosition = -1;
            var currentGroupItemsId = -1;
            var defaultGroupDataobject = JSON.parse('#{m_groupDefault}');

            function getGroupsDataObject() {
                return {
                    m_groupDefault: defaultGroupDataobject
                };
            }

            function initializeGroupsSpawnpointSelection(spawnpoints) {
                $('#inputGroupSpawnpointsSelect').html('');
                for (var i = 0; i < spawnpoints.length; i++) {
                    $('#inputGroupSpawnpointsSelect').append('<option value="' + i + '" ' + (i == (spawnpoints.length - 1) ? 'selected' : '') + '>' + spawnpoints[i]['m_name'] + '</option>');
                }
            }

            function initializeGroupsSpawnpointPosition(positions) {
                $('#inputGroupSpawnpointsPositionsSelection').html('');
                for (var i = 0; i < positions.length; i++) {
                    let pos = positions[i]['m_pos'];
                    $('#inputGroupSpawnpointsPositionsSelection').append('<option value="' + i + '" ' + (i == (positions.length - 1) ? 'selected' : '') + '>' + pos[0] + ' ' + pos[1] + ' ' + pos[2] + '</option>');
                }
            }

            function initializeGroupsGearItemsSelection(gearItems) {
                $('#inputGroupGearItems').html('');
                for (var i = 0; i < gearItems.length; i++) {
                    $('#inputGroupGearItems').append('<option value="' + i + '" ' + (i == (gearItems.length - 1) ? 'selected' : '') + '>' + gearItems[i]['m_name'] + '</option>');
                }
            }

            $('#inputGroupSpawnpointsSelect').change(function () {
                let inputs = '#inputGroupSpawnpointsName,#inputGroupSpawnpointsPositionsSelection';
                $('#inputGroupSpawnpointsPositionsSelection').html('');

                let groupSpawnpointId = $(this).val() != undefined ? parseInt($(this).val()) : -1;
                if (groupSpawnpointId != -1) {
                    $(inputs).prop("disabled", false);

                    let spawnpoint = defaultGroupDataobject['m_spawnpoints'][groupSpawnpointId];
                    $('#inputGroupSpawnpointsName').val(spawnpoint['m_name']);

                    initializeGroupsSpawnpointPosition(spawnpoint['m_positions']);
                }
                else {
                    $(inputs).val('');
                    $(inputs).prop("disabled", true);
                }

                currentGroupSpawnpointId = groupSpawnpointId;
                $('#inputGroupSpawnpointsPositionsSelection').change();
            });

            $('#inputGroupSpawnpointsPositionsSelection').change(function () {
                let inputs = '#inputGroupSpawnpointsPosition,#inputGroupSpawnpointsRadius';

                let groupSpawnpointPosition = $(this).val() != undefined ? parseInt($(this).val()) : -1;
                if (groupSpawnpointPosition != -1 && currentGroupSpawnpointId != -1) {
                    $(inputs).prop("disabled", false);

                    let position = defaultGroupDataobject['m_spawnpoints'][currentGroupSpawnpointId]['m_positions'][groupSpawnpointPosition];
                    $('#inputGroupSpawnpointsPosition').val(position['m_pos'][0] + ' ' + position['m_pos'][1] + ' ' + position['m_pos'][2]);
                    $('#inputGroupSpawnpointsRadius').val(position['m_radius']);
                }
                else {
                    $(inputs).val('');
                    $(inputs).prop("disabled", true);
                }

                currentGroupSpawnpointPosition = groupSpawnpointPosition;
            });

            $('#inputGroupGearItems').change(function () {
                let inputs = '#inputGroupGearItemsName,#inputGroupGearItemsList';

                let groupItemsId = $(this).val() != undefined ? parseInt($(this).val()) : -1;
                if (groupItemsId != -1) {
                    $(inputs).prop("disabled", false);

                    let itemData = defaultGroupDataobject['m_gearItems'][groupItemsId];
                    $('#inputGroupGearItemsName').val(itemData['m_name']);
                    $('#inputGroupGearItemsList').val(itemData['m_items'].join('\n'));
                }
                else {
                    $(inputs).val('');
                    $(inputs).prop("disabled", true);
                }

                currentGroupItemsId = groupItemsId;
            });

            $('#inputGroupGearBody').change(function () { defaultGroupDataobject['m_gearBody'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputGroupGearPants').change(function () { defaultGroupDataobject['m_gearPants'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputGroupGearShoes').change(function () { defaultGroupDataobject['m_gearFoot'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputGroupGearHeadgears').change(function () { defaultGroupDataobject['m_gearHead'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputGroupGearMasks').change(function () { defaultGroupDataobject['m_gearMask'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputGroupGearGloves').change(function () { defaultGroupDataobject['m_gearGloves'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputGroupGearVests').change(function () { defaultGroupDataobject['m_gearVest'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputGroupGearBackpacks').change(function () { defaultGroupDataobject['m_gearBackpack'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputGroupGearWeapons').change(function () { defaultGroupDataobject['m_gearWeapon'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputGroupSpawnpointsName').change(function () {
                if (currentGroupSpawnpointId != -1) {
                    defaultGroupDataobject['m_spawnpoints'][currentGroupSpawnpointId]['m_name'] = $(this).val();
                    $('#inputGroupSpawnpointsSelect').find('option[value="' + currentGroupSpawnpointId + '"]').text($(this).val());
                }
            });
            $('#inputGroupSpawnpointsPosition').change(function () {
                if (currentGroupSpawnpointId != -1 && currentGroupSpawnpointPosition != -1) {
                    let pos = $(this).val().split(' ').map(val => parseFloat(val));
                    defaultGroupDataobject['m_spawnpoints'][currentGroupSpawnpointId]['m_positions'][currentGroupSpawnpointPosition]['m_pos'] = pos;
                    $('#inputGroupSpawnpointsPositionsSelection').find('option[value="' + currentGroupSpawnpointPosition + '"]').text($(this).val());
                }
            });
            $('#inputGroupSpawnpointsRadius').change(function () {
                if (currentGroupSpawnpointId != -1 && currentGroupSpawnpointPosition != -1) {
                    let radius = parseFloat($(this).val());
                    defaultGroupDataobject['m_spawnpoints'][currentGroupSpawnpointId]['m_positions'][currentGroupSpawnpointPosition]['m_radius'] = radius;
                }
            });
            $('#inputGroupGearItemsName').change(function () {
                if (currentGroupItemsId != -1) {
                    defaultGroupDataobject['m_gearItems'][currentGroupItemsId]['m_name'] = $(this).val();
                    $('#inputGroupGearItems').find('option[value="' + currentGroupItemsId + '"]').text($(this).val());
                }
            });
            $('#inputGroupGearItemsList').change(function () {
                if (currentGroupItemsId != -1) {
                    defaultGroupDataobject['m_gearItems'][currentGroupItemsId]['m_items'] = $(this).val().split('\n').filter(n => n.trim());
                }
            });

            $('#inputGroupSpawnpointNew').click(function () {
                let spawnpoints = defaultGroupDataobject['m_spawnpoints'];
                spawnpoints.push({
                    m_name: 'Location ' + (spawnpoints.length + 1),
                    m_positions: []
                });

                initializeGroupsSpawnpointSelection(spawnpoints);
                $('#inputGroupSpawnpointsSelect').change();
            });
            $('#inputGroupSpawnpointDelete').click(function () {
                if (currentGroupSpawnpointId != -1) {
                    if (confirm('Are you sure you want to delete current spawn location?')) {
                        let spawnpoints = defaultGroupDataobject['m_spawnpoints'];
                        spawnpoints.remove(currentGroupSpawnpointId);
                        initializeGroupsSpawnpointSelection(spawnpoints);
                        $('#inputGroupSpawnpointsSelect').change();
                    }
                }
            });

            $('#inputGroupSpawnpointPositionNew').click(function () {
                if (currentGroupSpawnpointId != -1) {
                    let positions = defaultGroupDataobject['m_spawnpoints'][currentGroupSpawnpointId]['m_positions'];
                    positions.push({
                        m_pos: [0, 0, 0],
                        m_radius: 1
                    });

                    initializeGroupsSpawnpointPosition(positions);
                    $('#inputGroupSpawnpointsPositionsSelection').change();
                }
            });
            $('#inputGroupSpawnpointPositionDelete').click(function () {
                if (currentGroupSpawnpointId != -1 && currentGroupSpawnpointPosition != -1) {
                    let positions = defaultGroupDataobject['m_spawnpoints'][currentGroupSpawnpointId]['m_positions'];
                    positions.remove(currentGroupSpawnpointPosition);
                    initializeGroupsSpawnpointPosition(positions);
                    $('#inputGroupSpawnpointsPositionsSelection').change();
                }
            });

            $('#inputGroupGearItemsNew').click(function () {
                let gearItems = defaultGroupDataobject['m_gearItems'];
                gearItems.push({
                    m_name: 'Items Set ' + (gearItems.length + 1),
                    m_items: []
                });

                initializeGroupsGearItemsSelection(gearItems);
                $('#inputGroupGearItems').change();
            });
            $('#inputGroupGearItemsDelete').click(function () {
                if (currentGroupItemsId != -1) {
                    if (confirm('Are you sure you want to delete current group items set?')) {
                        let gearItems = defaultGroupDataobject['m_gearItems'];
                        gearItems.remove(currentGroupItemsId);
                        initializeGroupsGearItemsSelection(gearItems);
                        $('#inputGroupGearItems').change();
                    }
                }
            });

            $('#inputGroupGearBody').val(defaultGroupDataobject['m_gearBody'].join('\n'));
            $('#inputGroupGearPants').val(defaultGroupDataobject['m_gearPants'].join('\n'));
            $('#inputGroupGearShoes').val(defaultGroupDataobject['m_gearFoot'].join('\n'));
            $('#inputGroupGearHeadgears').val(defaultGroupDataobject['m_gearHead'].join('\n'));
            $('#inputGroupGearMasks').val(defaultGroupDataobject['m_gearMask'].join('\n'));
            $('#inputGroupGearGloves').val(defaultGroupDataobject['m_gearGloves'].join('\n'));
            $('#inputGroupGearVests').val(defaultGroupDataobject['m_gearVest'].join('\n'));
            $('#inputGroupGearBackpacks').val(defaultGroupDataobject['m_gearBackpack'].join('\n'));
            $('#inputGroupGearWeapons').val(defaultGroupDataobject['m_gearWeapon'].join('\n'));

            initializeGroupsSpawnpointSelection(defaultGroupDataobject['m_spawnpoints']);
            initializeGroupsGearItemsSelection(defaultGroupDataobject['m_gearItems']);
            $('#inputGroupSpawnpointsSelect').change();
            $('#inputGroupGearItems').change();
        </script>
    </div>
    <div class="tab-pane" id="factions" role="tabpanel" aria-labelledby="factions-tab">
        <h3>Factions:</h3>
        <div class="input-group">
            <div class="input-group-prepend">
                <button class="btn btn-outline-secondary" type="button" id="inputFactionNew">New</button>
            </div>
            <select class="custom-select" id="inputFactionsSelect"></select>
            <div class="input-group-append">
                <button class="btn btn-outline-secondary" type="button" id="inputFactionDelete">Delete</button>
            </div>
        </div>
        <p><em>Factions allow you to set a specific configuration of starting equipment and spawn points for a specific group of players. Each faction gets a group communication channel in the PDA. If you need to set starting equipment or spawn points for one player, please use the Loadouts tab.</em></p>
        <br>
        <h5>Faction parameters:</h5>
        <div class="form-group row">
            <label for="inputFactionName" class="col-sm-2 col-form-label">Faction name:</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="inputFactionName" required>
                <p><em>The faction name is displayed in the game in admin tools and in PDA.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputFactionLeaders" class="col-sm-2 col-form-label">Leaders:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputFactionLeaders"></textarea>
                <p><em>Specify the list of UIDs or SteamID64s of the leaders of faction. The leaders of the faction will gets an additional tab in the PDA for managing the members of the faction. A player can be a leader or member to only one faction at one time.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputFactionMaxMembers" class="col-sm-2 col-form-label">Maximum members count:</label>
            <div class="col-sm-10">
                <input type="number" min="1" max="1000" step="1" class="form-control" id="inputFactionMaxMembers" onchange="validateNumberInput(this)" required>
                <p><em>The maximum number of members who can simultaneously be in this faction.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputFactionAllowDefaultSpawnpoints" class="col-sm-2 col-form-label">Display default respawn locations on respawn screen:</label>
            <div class="col-sm-10">
                <input class="form-check-input" type="checkbox" id="inputFactionAllowDefaultSpawnpoints">
                <p><em>If this option is disabled - on the respawn screen, the member will have only respawn locations sets by the faction. If this option is enabled - the default locations will be combined with the faction's locations.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputFactionAllowDefaultLoadout" class="col-sm-2 col-form-label">Display default equipment on respawn screen:</label>
            <div class="col-sm-10">
                <input class="form-check-input" type="checkbox" id="inputFactionAllowDefaultLoadout">
                <p><em>If this option is disabled - on the respawn screen, the member will have only equipment sets by the faction. If this option is enabled - default equipment will be combined with the faction's equipment.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputFactionSpawnpointsSelect" class="col-sm-2 col-form-label">Respawn locations:</label>
            <div class="col-sm-10 input-group-btn">
                <div class="input-group-prepend">
                    <button class="btn btn-outline-secondary" type="button" id="inputFactionSpawnpointNew">Add</button>
                    <select class="form-control custom-select" id="inputFactionSpawnpointsSelect"></select>
                    <button class="btn btn-outline-secondary" type="button" id="inputFactionSpawnpointDelete">Remove</button>
                </div>
                <div class="row">
                    <div class="col col-sm-1">
                    </div>
                    <div class="col col-sm-11">
                        <label for="inputFactionSpawnpointsName">Name:</label>
                        <input type="text" class="form-control" id="inputFactionSpawnpointsName" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col col-sm-1">
                    </div>
                    <div class="col col-sm-11">
                        <label for="inputFactionSpawnpointsPositionsSelection">Points:</label>
                        <div class="input-group-prepend">
                            <button class="btn btn-outline-secondary" type="button" id="inputFactionSpawnpointPositionNew">Add</button>
                            <select class="form-control custom-select" id="inputFactionSpawnpointsPositionsSelection"></select>
                            <button class="btn btn-outline-secondary" type="button" id="inputFactionSpawnpointPositionDelete">Remove</button>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col col-sm-2">
                    </div>
                    <div class="col col-sm-6">
                        <label for="inputFactionSpawnpointsPosition">Position:</label>
                        <input type="text" class="form-control" onchange="validateVectorInput(this)" id="inputFactionSpawnpointsPosition" required>
                    </div>
                    <div class="col col-sm-4">
                        <label for="inputFactionSpawnpointsRadius">Radius:</label>
                        <input type="number" min="1" max="100" step="any" class="form-control" id="inputFactionSpawnpointsRadius" onchange="validateNumberInput(this)" required>
                    </div>
                </div>
                <br />
                <p>
                    <em>Respawn locations allow the player to select a specific spawn location while respawning. These spawn locations will be added to the list of default spawn locations.</em><br />
                    <em>The name of the location for the respawn will be displayed in the list on the player's respawn screen.</em><br />
                    <em>The points determine the list of possible points of the player's appearance in the given location. The selection of a point from a subset of all available ones occurs randomly.</em><br />
                    <em>The position is set with 3 numbers on the XYZ axes separated by spaces. You can find out the coordinates of the player's current position in the game using the admin tools.</em><br />
                    <em>The radius allows you to set a circle relative to the position inside which the player can respawn. Please do not set the radius too high to prevent the player from getting stuck in objects.</em>
                </p>
            </div>
        </div>
        <br>
        <br>
        <h5>Clothing & Weapons presets:</h5>
        <p><em>A list of items available for the player to select upon respawn from the list for each body part or weapon slot. The classname of each item should start on a new line. You can also set the amount and percent of damage to the item if necessary using additional parameters.</em></p>
        <div class="form-group row">
            <label for="inputFactionGearBody" class="col-sm-2 col-form-label">Body clothing:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputFactionGearBody"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">Hoodie_Black; H0.5</span><em> - Black hoodie with 50% health (Damaged)</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputFactionGearPants" class="col-sm-2 col-form-label">Pants:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputFactionGearPants"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">Jeans_Blue</span><em> - Blue jeans (Pristine)</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputFactionGearShoes" class="col-sm-2 col-form-label">Shoes:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputFactionGearShoes"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">AthleticShoes_Black; H0.8</span><em> - Shoes with 80% health</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputFactionGearHeadgears" class="col-sm-2 col-form-label">Headgears:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputFactionGearHeadgears"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">BoonieHat_Olive</span><em> - Boonie Hat (Pristine)</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputFactionGearMasks" class="col-sm-2 col-form-label">Masks:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputFactionGearMasks"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">GasMask; @GasMask_Filter</span><em> - Gas mask with filter in attachment.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputFactionGearGloves" class="col-sm-2 col-form-label">Gloves:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputFactionGearGloves"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">OMNOGloves_Gray</span></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputFactionGearVests" class="col-sm-2 col-form-label">Vests:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputFactionGearVests"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">PlateCarrierVest; H0.5; @PlateCarrierPouches,PlateCarrierHolster</span><em> - Damaged plate carrier with pouches and holster in attachments.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputFactionGearBackpacks" class="col-sm-2 col-form-label">Backpacks:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputFactionGearBackpacks"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">DryBag_Orange</span></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputFactionGearWeapons" class="col-sm-2 col-form-label">Weapons:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputFactionGearWeapons"></textarea>
                <p><em>Examples:</em> <span class="badge badge-info">M4A1; @M4_CarryHandleOptic,M4_CQBBttstck,M4_RISHndgrd; &Mag_STANAGCoupled_30Rnd; H0.5</span><em> - M4A1 with attachments or </em><span class="badge badge-info">Izh43Shotgun; &Ammo_12gaPellets</span><em> - double-barreled shotgun with ammo.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputFactionGearItems" class="col-sm-2 col-form-label">Item sets:</label>
            <div class="col-sm-10 input-group-btn">
                <div class="input-group-prepend">
                    <button class="btn btn-outline-secondary" type="button" id="inputFactionGearItemsNew">Add</button>
                    <select class="form-control custom-select" id="inputFactionGearItems"></select>
                    <button class="btn btn-outline-secondary" type="button" id="inputFactionGearItemsDelete">Remove</button>
                </div>
                <p><em>Determines the sets of items that the player can choose upon respawn. Each set can contain several items at the same time. The name of the set will be displayed to the player when choosing a starting equipment.</em></p>
                <div class="row">
                    <div class="col col-sm-1">
                    </div>
                    <div class="col col-sm-11">
                        <label for="inputFactionGearItemsName">Name:</label>
                        <input type="text" class="form-control" id="inputFactionGearItemsName" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col col-sm-1">
                    </div>
                    <div class="col col-sm-11">
                        <label for="inputFactionGearItemsList">Items:</label>
                        <textarea class="form-control" id="inputFactionGearItemsList"></textarea>
                    </div>
                </div>
            </div>
        </div>
        <div class="alert" role="alert" style="visibility: hidden" id="alertMessageFactions"></div>
        <button type="button" class="btn btn-primary btn-lg" wid onclick="savePageSettings(getFactionsDataObject(), '#alertMessageFactions')">Save</button>
        <script>
            var currentFactionId = -1;
            var currentFactionSpawnpointId = -1;
            var currentFactionSpawnpointPosition = -1;
            var currentFactionItemsId = -1;
            var factionsDataobject = JSON.parse('#{m_groupFactions}');

            function getFactionsDataObject() {
                return {
                    m_mainConfig: {
                        m_groups: factionsDataobject.map((faction, index) => {
                            return String(index)
                        })
                    },
                    m_groupFactions: factionsDataobject
                };
            }

            function initializeFactionsSelection() {
                $('#inputFactionsSelect').html('');
                for (var i = 0; i < factionsDataobject.length; i++) {
                    let factionObject = factionsDataobject[i];
                    $('#inputFactionsSelect').append('<option value="' + i + '" ' + (i == (factionsDataobject.length - 1) ? 'selected' : '') + '>' + factionObject['m_displayName'] + '</option>');
                }
            }

            function initializeFactionsSpawnpointSelection(spawnpoints) {
                $('#inputFactionSpawnpointsSelect').html('');
                for (var i = 0; i < spawnpoints.length; i++) {
                    $('#inputFactionSpawnpointsSelect').append('<option value="' + i + '" ' + (i == (spawnpoints.length - 1) ? 'selected' : '') + '>' + spawnpoints[i]['m_name'] + '</option>');
                }
            }

            function initializeFactionsSpawnpointPosition(positions) {
                $('#inputFactionSpawnpointsPositionsSelection').html('');
                for (var i = 0; i < positions.length; i++) {
                    let pos = positions[i]['m_pos'];
                    $('#inputFactionSpawnpointsPositionsSelection').append('<option value="' + i + '" ' + (i == (positions.length - 1) ? 'selected' : '') + '>' + pos[0] + ' ' + pos[1] + ' ' + pos[2] + '</option>');
                }
            }

            function initializeFactionsGearItemsSelection(gearItems) {
                $('#inputFactionGearItems').html('');
                for (var i = 0; i < gearItems.length; i++) {
                    $('#inputFactionGearItems').append('<option value="' + i + '" ' + (i == (gearItems.length - 1) ? 'selected' : '') + '>' + gearItems[i]['m_name'] + '</option>');
                }
            }

            initializeFactionsSelection();

            $('#inputFactionsSelect').change(function () {
                let inputs = '#inputFactionName,#inputFactionLeaders,#inputFactionMaxMembers,#inputFactionAllowDefaultSpawnpoints,#inputFactionAllowDefaultLoadout,#inputFactionGearBody,#inputFactionGearPants,#inputFactionGearShoes,#inputFactionGearHeadgears,' +
                    '#inputFactionGearMasks,#inputFactionGearGloves,#inputFactionGearVests,#inputFactionGearBackpacks,#inputFactionGearWeapons,#inputFactionSpawnpointsSelect';
                $('#inputFactionSpawnpointsSelect').html('');
                $('#inputFactionGearItems').html('');

                let factionId = $(this).val() != undefined ? parseInt($(this).val()) : -1;
                if (factionId != -1) {
                    $(inputs).prop("disabled", false);

                    let faction = factionsDataobject[factionId];
                    $('#inputFactionName').val(faction['m_displayName']);
                    $('#inputFactionLeaders').val(faction['m_leaders'].join('\n'));
                    $('#inputFactionMaxMembers').val(faction['m_maxMembers']);
                    $('#inputFactionAllowDefaultSpawnpoints').prop('checked', faction['m_allowDefaultSpawnpoints'] == 1);
                    $('#inputFactionAllowDefaultLoadout').prop('checked', faction['m_allowDefaultLoadout'] == 1);
                    $('#inputFactionGearBody').val(faction['m_gearBody'].join('\n'));
                    $('#inputFactionGearPants').val(faction['m_gearPants'].join('\n'));
                    $('#inputFactionGearShoes').val(faction['m_gearFoot'].join('\n'));
                    $('#inputFactionGearHeadgears').val(faction['m_gearHead'].join('\n'));
                    $('#inputFactionGearMasks').val(faction['m_gearMask'].join('\n'));
                    $('#inputFactionGearGloves').val(faction['m_gearGloves'].join('\n'));
                    $('#inputFactionGearVests').val(faction['m_gearVest'].join('\n'));
                    $('#inputFactionGearBackpacks').val(faction['m_gearBackpack'].join('\n'));
                    $('#inputFactionGearWeapons').val(faction['m_gearWeapon'].join('\n'));

                    initializeFactionsSpawnpointSelection(faction['m_spawnpoints']);
                    initializeFactionsGearItemsSelection(faction['m_gearItems']);
                }
                else {
                    $(inputs).val('');
                    $(inputs).prop("disabled", true);
                }

                currentFactionId = factionId;
                $('#inputFactionSpawnpointsSelect').change();
                $('#inputFactionGearItems').change();
            });

            $('#inputFactionSpawnpointsSelect').change(function () {
                let inputs = '#inputFactionSpawnpointsName,#inputFactionSpawnpointsPositionsSelection';
                $('#inputFactionSpawnpointsPositionsSelection').html('');

                let factionSpawnpointId = $(this).val() != undefined ? parseInt($(this).val()) : -1;
                if (factionSpawnpointId != -1 && currentFactionId != -1) {
                    $(inputs).prop("disabled", false);

                    let spawnpoint = factionsDataobject[currentFactionId]['m_spawnpoints'][factionSpawnpointId];
                    $('#inputFactionSpawnpointsName').val(spawnpoint['m_name']);

                    initializeFactionsSpawnpointPosition(spawnpoint['m_positions']);
                }
                else {
                    $(inputs).val('');
                    $(inputs).prop("disabled", true);
                }

                currentFactionSpawnpointId = factionSpawnpointId;
                $('#inputFactionSpawnpointsPositionsSelection').change();
            });

            $('#inputFactionSpawnpointsPositionsSelection').change(function () {
                let inputs = '#inputFactionSpawnpointsPosition,#inputFactionSpawnpointsRadius';

                let factionSpawnpointPosition = $(this).val() != undefined ? parseInt($(this).val()) : -1;
                if (factionSpawnpointPosition != -1 && currentFactionSpawnpointId != -1 && currentFactionId != -1) {
                    $(inputs).prop("disabled", false);

                    let position = factionsDataobject[currentFactionId]['m_spawnpoints'][currentFactionSpawnpointId]['m_positions'][factionSpawnpointPosition];
                    $('#inputFactionSpawnpointsPosition').val(position['m_pos'][0] + ' ' + position['m_pos'][1] + ' ' + position['m_pos'][2]);
                    $('#inputFactionSpawnpointsRadius').val(position['m_radius']);
                }
                else {
                    $(inputs).val('');
                    $(inputs).prop("disabled", true);
                }

                currentFactionSpawnpointPosition = factionSpawnpointPosition;
            });

            $('#inputFactionGearItems').change(function () {
                let inputs = '#inputFactionGearItemsName,#inputFactionGearItemsList';

                let factionItemsId = $(this).val() != undefined ? parseInt($(this).val()) : -1;
                if (factionItemsId != -1 && currentFactionId != -1) {
                    $(inputs).prop("disabled", false);

                    let itemData = factionsDataobject[currentFactionId]['m_gearItems'][factionItemsId];
                    $('#inputFactionGearItemsName').val(itemData['m_name']);
                    $('#inputFactionGearItemsList').val(itemData['m_items'].join('\n'));
                }
                else {
                    $(inputs).val('');
                    $(inputs).prop("disabled", true);
                }

                currentFactionItemsId = factionItemsId;
            });

            $('#inputFactionName').change(function () {
                if (currentFactionId != -1) {
                    factionsDataobject[currentFactionId]['m_displayName'] = $(this).val();
                    $('#inputFactionsSelect').find('option[value="' + currentFactionId + '"]').text($(this).val());
                }
            });
            $('#inputFactionLeaders').change(function () { if (currentFactionId != -1) factionsDataobject[currentFactionId]['m_leaders'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputFactionMaxMembers').change(function () { if (currentFactionId != -1) factionsDataobject[currentFactionId]['m_maxMembers'] = parseInt($(this).val()); });
            $('#inputFactionAllowDefaultSpawnpoints').change(function () { if (currentFactionId != -1) factionsDataobject[currentFactionId]['m_allowDefaultSpawnpoints'] = $(this).is(':checked') ? 1 : 0; });
            $('#inputFactionAllowDefaultLoadout').change(function () { if (currentFactionId != -1) factionsDataobject[currentFactionId]['m_allowDefaultLoadout'] = $(this).is(':checked') ? 1 : 0; });
            $('#inputFactionGearBody').change(function () { if (currentFactionId != -1) factionsDataobject[currentFactionId]['m_gearBody'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputFactionGearPants').change(function () { if (currentFactionId != -1) factionsDataobject[currentFactionId]['m_gearPants'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputFactionGearShoes').change(function () { if (currentFactionId != -1) factionsDataobject[currentFactionId]['m_gearFoot'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputFactionGearHeadgears').change(function () { if (currentFactionId != -1) factionsDataobject[currentFactionId]['m_gearHead'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputFactionGearMasks').change(function () { if (currentFactionId != -1) factionsDataobject[currentFactionId]['m_gearMask'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputFactionGearGloves').change(function () { if (currentFactionId != -1) factionsDataobject[currentFactionId]['m_gearGloves'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputFactionGearVests').change(function () { if (currentFactionId != -1) factionsDataobject[currentFactionId]['m_gearVest'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputFactionGearBackpacks').change(function () { if (currentFactionId != -1) factionsDataobject[currentFactionId]['m_gearBackpack'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputFactionGearWeapons').change(function () { if (currentFactionId != -1) factionsDataobject[currentFactionId]['m_gearWeapon'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputFactionSpawnpointsName').change(function () {
                if (currentFactionId != -1 && currentFactionSpawnpointId != -1) {
                    factionsDataobject[currentFactionId]['m_spawnpoints'][currentFactionSpawnpointId]['m_name'] = $(this).val();
                    $('#inputFactionSpawnpointsSelect').find('option[value="' + currentFactionSpawnpointId + '"]').text($(this).val());
                }
            });
            $('#inputFactionSpawnpointsPosition').change(function () {
                if (currentFactionId != -1 && currentFactionSpawnpointId != -1 && currentFactionSpawnpointPosition != -1) {
                    let pos = $(this).val().split(' ').map(val => parseFloat(val));
                    factionsDataobject[currentFactionId]['m_spawnpoints'][currentFactionSpawnpointId]['m_positions'][currentFactionSpawnpointPosition]['m_pos'] = pos;
                    $('#inputFactionSpawnpointsPositionsSelection').find('option[value="' + currentFactionSpawnpointPosition + '"]').text($(this).val());
                }
            });
            $('#inputFactionSpawnpointsRadius').change(function () {
                if (currentFactionId != -1 && currentFactionSpawnpointId != -1 && currentFactionSpawnpointPosition != -1) {
                    let radius = parseFloat($(this).val());
                    factionsDataobject[currentFactionId]['m_spawnpoints'][currentFactionSpawnpointId]['m_positions'][currentFactionSpawnpointPosition]['m_radius'] = radius;
                }
            });
            $('#inputFactionGearItemsName').change(function () {
                if (currentFactionId != -1 && currentFactionItemsId != -1) {
                    factionsDataobject[currentFactionId]['m_gearItems'][currentFactionItemsId]['m_name'] = $(this).val();
                    $('#inputFactionGearItems').find('option[value="' + currentFactionItemsId + '"]').text($(this).val());
                }
            });
            $('#inputFactionGearItemsList').change(function () {
                if (currentFactionId != -1 && currentFactionItemsId != -1) {
                    factionsDataobject[currentFactionId]['m_gearItems'][currentFactionItemsId]['m_items'] = $(this).val().split('\n').filter(n => n.trim());
                }
            });

            $('#inputFactionNew').click(function () {
                factionsDataobject.push({
                    m_displayName: 'Faction ' + (factionsDataobject.length + 1),
                    m_maxMembers: 100,
                    m_allowDefaultSpawnpoints: 1,
                    m_allowDefaultLoadout: 1,
                    m_leaders: [],
                    m_spawnpoints: [],
                    m_gearBody: [],
                    m_gearPants: [],
                    m_gearFoot: [],
                    m_gearHead: [],
                    m_gearMask: [],
                    m_gearGloves: [],
                    m_gearVest: [],
                    m_gearBackpack: [],
                    m_gearWeapon: [],
                    m_gearItems: []
                });

                initializeFactionsSelection();
                $('#inputFactionsSelect').change();
            });
            $('#inputFactionDelete').click(function () {
                if (currentFactionId != -1) {
                    if (confirm('Are you sure you want to delete current faction?')) {
                        factionsDataobject.remove(currentFactionId);
                        initializeFactionsSelection();
                        $('#inputFactionsSelect').change();
                    }
                }
            });

            $('#inputFactionSpawnpointNew').click(function () {
                if (currentFactionId != -1) {
                    let spawnpoints = factionsDataobject[currentFactionId]['m_spawnpoints'];
                    spawnpoints.push({
                        m_name: 'Location ' + (spawnpoints.length + 1),
                        m_positions: []
                    });

                    initializeFactionsSpawnpointSelection(spawnpoints);
                    $('#inputFactionSpawnpointsSelect').change();
                }
            });
            $('#inputFactionSpawnpointDelete').click(function () {
                if (currentFactionId != -1 && currentFactionSpawnpointId != -1) {
                    if (confirm('Are you sure you want to delete current spawn location?')) {
                        let spawnpoints = factionsDataobject[currentFactionId]['m_spawnpoints'];
                        spawnpoints.remove(currentFactionSpawnpointId);
                        initializeFactionsSpawnpointSelection(spawnpoints);
                        $('#inputFactionSpawnpointsSelect').change();
                    }
                }
            });

            $('#inputFactionSpawnpointPositionNew').click(function () {
                if (currentFactionId != -1 && currentFactionSpawnpointId != -1) {
                    let positions = factionsDataobject[currentFactionId]['m_spawnpoints'][currentFactionSpawnpointId]['m_positions'];
                    positions.push({
                        m_pos: [0, 0, 0],
                        m_radius: 1
                    });

                    initializeFactionsSpawnpointPosition(positions);
                    $('#inputFactionSpawnpointsPositionsSelection').change();
                }
            });
            $('#inputFactionSpawnpointPositionDelete').click(function () {
                if (currentFactionId != -1 && currentFactionSpawnpointId != -1 && currentFactionSpawnpointPosition != -1) {
                    let positions = factionsDataobject[currentFactionId]['m_spawnpoints'][currentFactionSpawnpointId]['m_positions'];
                    positions.remove(currentFactionSpawnpointPosition);
                    initializeFactionsSpawnpointPosition(positions);
                    $('#inputFactionSpawnpointsPositionsSelection').change();
                }
            });

            $('#inputFactionGearItemsNew').click(function () {
                if (currentFactionId != -1) {
                    let gearItems = factionsDataobject[currentFactionId]['m_gearItems'];
                    gearItems.push({
                        m_name: 'Items Set ' + (gearItems.length + 1),
                        m_items: []
                    });

                    initializeFactionsGearItemsSelection(gearItems);
                    $('#inputFactionGearItems').change();
                }
            });
            $('#inputFactionGearItemsDelete').click(function () {
                if (currentFactionId != -1 && currentFactionItemsId != -1) {
                    if (confirm('Are you sure you want to delete current faction items set?')) {
                        let gearItems = factionsDataobject[currentFactionId]['m_gearItems'];
                        gearItems.remove(currentFactionItemsId);
                        initializeFactionsGearItemsSelection(gearItems);
                        $('#inputFactionGearItems').change();
                    }
                }
            });

            $('#inputFactionsSelect').change();
        </script>
    </div>
    <div class="tab-pane" id="loadouts" role="tabpanel" aria-labelledby="loadouts-tab">
        <h3>Personal loadouts:</h3>
        <div class="input-group">
            <div class="input-group-prepend">
                <button class="btn btn-outline-secondary" type="button" id="inputLoadoutNew">New</button>
            </div>
            <select class="custom-select" id="inputLoadoutsSelect"></select>
            <div class="input-group-append">
                <button class="btn btn-outline-secondary" type="button" id="inputLoadoutDelete">Delete</button>
            </div>
        </div>
        <p><em>Personal Loadouts allow you to set a specific configuration of starting equipment and spawn points for a specific player. If you need to set starting equipment or spawn points for a group of players, please use the Factions tab.</em></p>
        <br>
        <h5>Loadout parameters:</h5>
        <div class="form-group row">
            <label for="inputLoadoutName" class="col-sm-2 col-form-label">Loadout name:</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="inputLoadoutName" required>
                <p><em>The loadout name is displayed only in the admin panel and is required only for ease to use.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputLoadoutUid" class="col-sm-2 col-form-label">Player UID:</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="inputLoadoutUid" required>
                <p><em>Specify the UID or SteamID64 of the player to which this ladout will be applied.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputLoadoutSpawnpointsSelect" class="col-sm-2 col-form-label">Respawn locations:</label>
            <div class="col-sm-10 input-group-btn">
                <div class="input-group-prepend">
                    <button class="btn btn-outline-secondary" type="button" id="inputLoadoutSpawnpointNew">Add</button>
                    <select class="form-control custom-select" id="inputLoadoutSpawnpointsSelect"></select>
                    <button class="btn btn-outline-secondary" type="button" id="inputLoadoutSpawnpointDelete">Remove</button>
                </div>
                <div class="row">
                    <div class="col col-sm-1">
                    </div>
                    <div class="col col-sm-11">
                        <label for="inputLoadoutSpawnpointsName">Name:</label>
                        <input type="text" class="form-control" id="inputLoadoutSpawnpointsName" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col col-sm-1">
                    </div>
                    <div class="col col-sm-11">
                        <label for="inputLoadoutSpawnpointsPositionsSelection">Points:</label>
                        <div class="input-group-prepend">
                            <button class="btn btn-outline-secondary" type="button" id="inputLoadoutSpawnpointPositionNew">Add</button>
                            <select class="form-control custom-select" id="inputLoadoutSpawnpointsPositionsSelection"></select>
                            <button class="btn btn-outline-secondary" type="button" id="inputLoadoutSpawnpointPositionDelete">Remove</button>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col col-sm-2">
                    </div>
                    <div class="col col-sm-6">
                        <label for="inputLoadoutSpawnpointsPosition">Position:</label>
                        <input type="text" class="form-control" onchange="validateVectorInput(this)" id="inputLoadoutSpawnpointsPosition" required>
                    </div>
                    <div class="col col-sm-4">
                        <label for="inputLoadoutSpawnpointsRadius">Radius:</label>
                        <input type="number" min="1" max="100" step="any" class="form-control" id="inputLoadoutSpawnpointsRadius" onchange="validateNumberInput(this)" required>
                    </div>
                </div>
                <br />
                <p>
                    <em>Respawn locations allow the player to select a specific spawn location while respawning. These spawn locations will be added to the list of default spawn locations.</em><br />
                    <em>The name of the location for the respawn will be displayed in the list on the player's respawn screen.</em><br />
                    <em>The points determine the list of possible points of the player's appearance in the given location. The selection of a point from a subset of all available ones occurs randomly.</em><br />
                    <em>The position is set with 3 numbers on the XYZ axes separated by spaces. You can find out the coordinates of the player's current position in the game using the admin tools.</em><br />
                    <em>The radius allows you to set a circle relative to the position inside which the player can respawn. Please do not set the radius too high to prevent the player from getting stuck in objects.</em>
                </p>
            </div>
        </div>
        <br>
        <br>
        <h5>Clothing & Weapons presets:</h5>
        <p><em>A list of items available for the player to select upon respawn from the list for each body part or weapon slot. The classname of each item should start on a new line. You can also set the amount and percent of damage to the item if necessary using additional parameters.</em></p>
        <div class="form-group row">
            <label for="inputLoadoutGearBody" class="col-sm-2 col-form-label">Body clothing:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputLoadoutGearBody"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">Hoodie_Black; H0.5</span><em> - Black hoodie with 50% health (Damaged)</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputLoadoutGearPants" class="col-sm-2 col-form-label">Pants:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputLoadoutGearPants"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">Jeans_Blue</span><em> - Blue jeans (Pristine)</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputLoadoutGearShoes" class="col-sm-2 col-form-label">Shoes:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputLoadoutGearShoes"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">AthleticShoes_Black; H0.8</span><em> - Shoes with 80% health</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputLoadoutGearHeadgears" class="col-sm-2 col-form-label">Headgears:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputLoadoutGearHeadgears"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">BoonieHat_Olive</span><em> - Boonie Hat (Pristine)</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputLoadoutGearMasks" class="col-sm-2 col-form-label">Masks:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputLoadoutGearMasks"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">GasMask; @GasMask_Filter</span><em> - Gas mask with filter in attachment.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputLoadoutGearGloves" class="col-sm-2 col-form-label">Gloves:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputLoadoutGearGloves"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">OMNOGloves_Gray</span></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputLoadoutGearVests" class="col-sm-2 col-form-label">Vests:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputLoadoutGearVests"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">PlateCarrierVest; H0.5; @PlateCarrierPouches,PlateCarrierHolster</span><em> - Damaged plate carrier with pouches and holster in attachments.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputLoadoutGearBackpacks" class="col-sm-2 col-form-label">Backpacks:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputLoadoutGearBackpacks"></textarea>
                <p><em>Example:</em> <span class="badge badge-info">DryBag_Orange</span></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputLoadoutGearWeapons" class="col-sm-2 col-form-label">Weapons:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputLoadoutGearWeapons"></textarea>
                <p><em>Examples:</em> <span class="badge badge-info">M4A1; @M4_CarryHandleOptic,M4_CQBBttstck,M4_RISHndgrd; &Mag_STANAGCoupled_30Rnd; H0.5</span><em> - M4A1 with attachments or </em><span class="badge badge-info">Izh43Shotgun; &Ammo_12gaPellets</span><em> - double-barreled shotgun with ammo.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputLoadoutGearItems" class="col-sm-2 col-form-label">Item sets:</label>
            <div class="col-sm-10 input-group-btn">
                <div class="input-group-prepend">
                    <button class="btn btn-outline-secondary" type="button" id="inputLoadoutGearItemsNew">Add</button>
                    <select class="form-control custom-select" id="inputLoadoutGearItems"></select>
                    <button class="btn btn-outline-secondary" type="button" id="inputLoadoutGearItemsDelete">Remove</button>
                </div>
                <p><em>Determines the sets of items that the player can choose upon respawn. Each set can contain several items at the same time. The name of the set will be displayed to the player when choosing a starting equipment.</em></p>
                <div class="row">
                    <div class="col col-sm-1">
                    </div>
                    <div class="col col-sm-11">
                        <label for="inputLoadoutGearItemsName">Name:</label>
                        <input type="text" class="form-control" id="inputLoadoutGearItemsName" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col col-sm-1">
                    </div>
                    <div class="col col-sm-11">
                        <label for="inputLoadoutGearItemsList">Items:</label>
                        <textarea class="form-control" id="inputLoadoutGearItemsList"></textarea>
                    </div>
                </div>
            </div>
        </div>
        <div class="alert" role="alert" style="visibility: hidden" id="alertMessageLoadouts"></div>
        <button type="button" class="btn btn-primary btn-lg" wid onclick="savePageSettings(getLoadoutsDataObject(), '#alertMessageLoadouts')">Save</button>
        <script>
            var currentLoadoutId = -1;
            var currentLoadoutSpawnpointId = -1;
            var currentLoadoutSpawnpointPosition = -1;
            var currentLoadoutItemsId = -1;
            var loadoutsDataobject = JSON.parse('#{m_customLoadouts}');

            function getLoadoutsDataObject() {
                return {
                    m_customLoadouts: loadoutsDataobject
                };
            }

            function initializeLoadoutsSelection() {
                $('#inputLoadoutsSelect').html('');
                for (var i = 0; i < loadoutsDataobject.length; i++) {
                    let loadoutObject = loadoutsDataobject[i];
                    $('#inputLoadoutsSelect').append('<option value="' + i + '" ' + (i == (loadoutsDataobject.length - 1) ? 'selected' : '') + '>' + loadoutObject['m_displayName'] + '</option>');
                }
            }

            function initializeLoadoutsSpawnpointSelection(spawnpoints) {
                $('#inputLoadoutSpawnpointsSelect').html('');
                for (var i = 0; i < spawnpoints.length; i++) {
                    $('#inputLoadoutSpawnpointsSelect').append('<option value="' + i + '" ' + (i == (spawnpoints.length - 1) ? 'selected' : '') + '>' + spawnpoints[i]['m_name'] + '</option>');
                }
            }

            function initializeLoadoutsSpawnpointPosition(positions) {
                $('#inputLoadoutSpawnpointsPositionsSelection').html('');
                for (var i = 0; i < positions.length; i++) {
                    let pos = positions[i]['m_pos'];
                    $('#inputLoadoutSpawnpointsPositionsSelection').append('<option value="' + i + '" ' + (i == (positions.length - 1) ? 'selected' : '') + '>' + pos[0] + ' ' + pos[1] + ' ' + pos[2] + '</option>');
                }
            }

            function initializeLoadoutsGearItemsSelection(gearItems) {
                $('#inputLoadoutGearItems').html('');
                for (var i = 0; i < gearItems.length; i++) {
                    $('#inputLoadoutGearItems').append('<option value="' + i + '" ' + (i == (gearItems.length - 1) ? 'selected' : '') + '>' + gearItems[i]['m_name'] + '</option>');
                }
            }

            initializeLoadoutsSelection();

            $('#inputLoadoutsSelect').change(function () {
                let inputs = '#inputLoadoutName,#inputLoadoutUid,#inputLoadoutGearBody,#inputLoadoutGearPants,#inputLoadoutGearShoes,#inputLoadoutGearHeadgears,' +
                    '#inputLoadoutGearMasks,#inputLoadoutGearGloves,#inputLoadoutGearVests,#inputLoadoutGearBackpacks,#inputLoadoutGearWeapons,#inputLoadoutSpawnpointsSelect';
                $('#inputLoadoutSpawnpointsSelect').html('');
                $('#inputLoadoutGearItems').html('');

                let loadoutId = $(this).val() != undefined ? parseInt($(this).val()) : -1;
                if (loadoutId != -1) {
                    $(inputs).prop("disabled", false);

                    let loadout = loadoutsDataobject[loadoutId];
                    $('#inputLoadoutName').val(loadout['m_displayName']);
                    $('#inputLoadoutUid').val(loadout['m_uid']);
                    $('#inputLoadoutGearBody').val(loadout['m_gearBody'].join('\n'));
                    $('#inputLoadoutGearPants').val(loadout['m_gearPants'].join('\n'));
                    $('#inputLoadoutGearShoes').val(loadout['m_gearFoot'].join('\n'));
                    $('#inputLoadoutGearHeadgears').val(loadout['m_gearHead'].join('\n'));
                    $('#inputLoadoutGearMasks').val(loadout['m_gearMask'].join('\n'));
                    $('#inputLoadoutGearGloves').val(loadout['m_gearGloves'].join('\n'));
                    $('#inputLoadoutGearVests').val(loadout['m_gearVest'].join('\n'));
                    $('#inputLoadoutGearBackpacks').val(loadout['m_gearBackpack'].join('\n'));
                    $('#inputLoadoutGearWeapons').val(loadout['m_gearWeapon'].join('\n'));

                    initializeLoadoutsSpawnpointSelection(loadout['m_spawnpoints']);
                    initializeLoadoutsGearItemsSelection(loadout['m_gearItems']);
                }
                else {
                    $(inputs).val('');
                    $(inputs).prop("disabled", true);
                }

                currentLoadoutId = loadoutId;
                $('#inputLoadoutSpawnpointsSelect').change();
                $('#inputLoadoutGearItems').change();
            });

            $('#inputLoadoutSpawnpointsSelect').change(function () {
                let inputs = '#inputLoadoutSpawnpointsName,#inputLoadoutSpawnpointsPositionsSelection';
                $('#inputLoadoutSpawnpointsPositionsSelection').html('');

                let loadoutSpawnpointId = $(this).val() != undefined ? parseInt($(this).val()) : -1;
                if (loadoutSpawnpointId != -1 && currentLoadoutId != -1) {
                    $(inputs).prop("disabled", false);

                    let spawnpoint = loadoutsDataobject[currentLoadoutId]['m_spawnpoints'][loadoutSpawnpointId];
                    $('#inputLoadoutSpawnpointsName').val(spawnpoint['m_name']);

                    initializeLoadoutsSpawnpointPosition(spawnpoint['m_positions']);
                }
                else {
                    $(inputs).val('');
                    $(inputs).prop("disabled", true);
                }

                currentLoadoutSpawnpointId = loadoutSpawnpointId;
                $('#inputLoadoutSpawnpointsPositionsSelection').change();
            });

            $('#inputLoadoutSpawnpointsPositionsSelection').change(function () {
                let inputs = '#inputLoadoutSpawnpointsPosition,#inputLoadoutSpawnpointsRadius';

                let loadoutSpawnpointPosition = $(this).val() != undefined ? parseInt($(this).val()) : -1;
                if (loadoutSpawnpointPosition != -1 && currentLoadoutSpawnpointId != -1 && currentLoadoutId != -1) {
                    $(inputs).prop("disabled", false);

                    let position = loadoutsDataobject[currentLoadoutId]['m_spawnpoints'][currentLoadoutSpawnpointId]['m_positions'][loadoutSpawnpointPosition];
                    $('#inputLoadoutSpawnpointsPosition').val(position['m_pos'][0] + ' ' + position['m_pos'][1] + ' ' + position['m_pos'][2]);
                    $('#inputLoadoutSpawnpointsRadius').val(position['m_radius']);
                }
                else {
                    $(inputs).val('');
                    $(inputs).prop("disabled", true);
                }

                currentLoadoutSpawnpointPosition = loadoutSpawnpointPosition;
            });

            $('#inputLoadoutGearItems').change(function () {
                let inputs = '#inputLoadoutGearItemsName,#inputLoadoutGearItemsList';

                let loadoutItemsId = $(this).val() != undefined ? parseInt($(this).val()) : -1;
                if (loadoutItemsId != -1 && currentLoadoutId != -1) {
                    $(inputs).prop("disabled", false);

                    let itemData = loadoutsDataobject[currentLoadoutId]['m_gearItems'][loadoutItemsId];
                    $('#inputLoadoutGearItemsName').val(itemData['m_name']);
                    $('#inputLoadoutGearItemsList').val(itemData['m_items'].join('\n'));
                }
                else {
                    $(inputs).val('');
                    $(inputs).prop("disabled", true);
                }

                currentLoadoutItemsId = loadoutItemsId;
            });

            $('#inputLoadoutName').change(function () {
                if (currentLoadoutId != -1) {
                    loadoutsDataobject[currentLoadoutId]['m_displayName'] = $(this).val();
                    $('#inputLoadoutsSelect').find('option[value="' + currentLoadoutId + '"]').text($(this).val());
                }
            });
            $('#inputLoadoutUid').change(function () { if (currentLoadoutId != -1) loadoutsDataobject[currentLoadoutId]['m_uid'] = $(this).val(); });
            $('#inputLoadoutGearBody').change(function () { if (currentLoadoutId != -1) loadoutsDataobject[currentLoadoutId]['m_gearBody'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputLoadoutGearPants').change(function () { if (currentLoadoutId != -1) loadoutsDataobject[currentLoadoutId]['m_gearPants'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputLoadoutGearShoes').change(function () { if (currentLoadoutId != -1) loadoutsDataobject[currentLoadoutId]['m_gearFoot'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputLoadoutGearHeadgears').change(function () { if (currentLoadoutId != -1) loadoutsDataobject[currentLoadoutId]['m_gearHead'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputLoadoutGearMasks').change(function () { if (currentLoadoutId != -1) loadoutsDataobject[currentLoadoutId]['m_gearMask'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputLoadoutGearGloves').change(function () { if (currentLoadoutId != -1) loadoutsDataobject[currentLoadoutId]['m_gearGloves'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputLoadoutGearVests').change(function () { if (currentLoadoutId != -1) loadoutsDataobject[currentLoadoutId]['m_gearVest'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputLoadoutGearBackpacks').change(function () { if (currentLoadoutId != -1) loadoutsDataobject[currentLoadoutId]['m_gearBackpack'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputLoadoutGearWeapons').change(function () { if (currentLoadoutId != -1) loadoutsDataobject[currentLoadoutId]['m_gearWeapon'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputLoadoutSpawnpointsName').change(function () {
                if (currentLoadoutId != -1 && currentLoadoutSpawnpointId != -1) {
                    loadoutsDataobject[currentLoadoutId]['m_spawnpoints'][currentLoadoutSpawnpointId]['m_name'] = $(this).val();
                    $('#inputLoadoutSpawnpointsSelect').find('option[value="' + currentLoadoutSpawnpointId + '"]').text($(this).val());
                }
            });
            $('#inputLoadoutSpawnpointsPosition').change(function () {
                if (currentLoadoutId != -1 && currentLoadoutSpawnpointId != -1 && currentLoadoutSpawnpointPosition != -1) {
                    let pos = $(this).val().split(' ').map(val => parseFloat(val));
                    loadoutsDataobject[currentLoadoutId]['m_spawnpoints'][currentLoadoutSpawnpointId]['m_positions'][currentLoadoutSpawnpointPosition]['m_pos'] = pos;
                    $('#inputLoadoutSpawnpointsPositionsSelection').find('option[value="' + currentLoadoutSpawnpointPosition + '"]').text($(this).val());
                }
            });
            $('#inputLoadoutSpawnpointsRadius').change(function () {
                if (currentLoadoutId != -1 && currentLoadoutSpawnpointId != -1 && currentLoadoutSpawnpointPosition != -1) {
                    let radius = parseFloat($(this).val());
                    loadoutsDataobject[currentLoadoutId]['m_spawnpoints'][currentLoadoutSpawnpointId]['m_positions'][currentLoadoutSpawnpointPosition]['m_radius'] = radius;
                }
            });
            $('#inputLoadoutGearItemsName').change(function () {
                if (currentLoadoutId != -1 && currentLoadoutItemsId != -1) {
                    loadoutsDataobject[currentLoadoutId]['m_gearItems'][currentLoadoutItemsId]['m_name'] = $(this).val();
                    $('#inputLoadoutGearItems').find('option[value="' + currentLoadoutItemsId + '"]').text($(this).val());
                }
            });
            $('#inputLoadoutGearItemsList').change(function () {
                if (currentLoadoutId != -1 && currentLoadoutItemsId != -1) {
                    loadoutsDataobject[currentLoadoutId]['m_gearItems'][currentLoadoutItemsId]['m_items'] = $(this).val().split('\n').filter(n => n.trim());
                }
            });

            $('#inputLoadoutNew').click(function () {
                loadoutsDataobject.push({
                    m_displayName: 'Loadout ' + (loadoutsDataobject.length + 1),
                    m_uid: '',
                    m_spawnpoints: [],
                    m_gearBody: [],
                    m_gearPants: [],
                    m_gearFoot: [],
                    m_gearHead: [],
                    m_gearMask: [],
                    m_gearGloves: [],
                    m_gearVest: [],
                    m_gearBackpack: [],
                    m_gearWeapon: [],
                    m_gearItems: []
                });

                initializeLoadoutsSelection();
                $('#inputLoadoutsSelect').change();
            });
            $('#inputLoadoutDelete').click(function () {
                if (currentLoadoutId != -1) {
                    if (confirm('Are you sure you want to delete current loadout?')) {
                        loadoutsDataobject.remove(currentLoadoutId);
                        initializeLoadoutsSelection();
                        $('#inputLoadoutsSelect').change();
                    }
                }
            });

            $('#inputLoadoutSpawnpointNew').click(function () {
                if (currentLoadoutId != -1) {
                    let spawnpoints = loadoutsDataobject[currentLoadoutId]['m_spawnpoints'];
                    spawnpoints.push({
                        m_name: 'Location ' + (spawnpoints.length + 1),
                        m_positions: []
                    });

                    initializeLoadoutsSpawnpointSelection(spawnpoints);
                    $('#inputLoadoutSpawnpointsSelect').change();
                }
            });
            $('#inputLoadoutSpawnpointDelete').click(function () {
                if (currentLoadoutId != -1 && currentLoadoutSpawnpointId != -1) {
                    if (confirm('Are you sure you want to delete current spawn location?')) {
                        let spawnpoints = loadoutsDataobject[currentLoadoutId]['m_spawnpoints'];
                        spawnpoints.remove(currentLoadoutSpawnpointId);
                        initializeLoadoutsSpawnpointSelection(spawnpoints);
                        $('#inputLoadoutSpawnpointsSelect').change();
                    }
                }
            });

            $('#inputLoadoutSpawnpointPositionNew').click(function () {
                if (currentLoadoutId != -1 && currentLoadoutSpawnpointId != -1) {
                    let positions = loadoutsDataobject[currentLoadoutId]['m_spawnpoints'][currentLoadoutSpawnpointId]['m_positions'];
                    positions.push({
                        m_pos: [0, 0, 0],
                        m_radius: 1
                    });

                    initializeLoadoutsSpawnpointPosition(positions);
                    $('#inputLoadoutSpawnpointsPositionsSelection').change();
                }
            });
            $('#inputLoadoutSpawnpointPositionDelete').click(function () {
                if (currentLoadoutId != -1 && currentLoadoutSpawnpointId != -1 && currentLoadoutSpawnpointPosition != -1) {
                    let positions = loadoutsDataobject[currentLoadoutId]['m_spawnpoints'][currentLoadoutSpawnpointId]['m_positions'];
                    positions.remove(currentLoadoutSpawnpointPosition);
                    initializeLoadoutsSpawnpointPosition(positions);
                    $('#inputLoadoutSpawnpointsPositionsSelection').change();
                }
            });

            $('#inputLoadoutGearItemsNew').click(function () {
                if (currentLoadoutId != -1) {
                    let gearItems = loadoutsDataobject[currentLoadoutId]['m_gearItems'];
                    gearItems.push({
                        m_name: 'Items Set ' + (gearItems.length + 1),
                        m_items: []
                    });

                    initializeLoadoutsGearItemsSelection(gearItems);
                    $('#inputLoadoutGearItems').change();
                }
            });
            $('#inputLoadoutGearItemsDelete').click(function () {
                if (currentLoadoutId != -1 && currentLoadoutItemsId != -1) {
                    if (confirm('Are you sure you want to delete current loadout items set?')) {
                        let gearItems = loadoutsDataobject[currentLoadoutId]['m_gearItems'];
                        gearItems.remove(currentLoadoutItemsId);
                        initializeLoadoutsGearItemsSelection(gearItems);
                        $('#inputLoadoutGearItems').change();
                    }
                }
            });

            $('#inputLoadoutsSelect').change();
        </script>
    </div>
    <div class="tab-pane" id="traders" role="tabpanel" aria-labelledby="traders-tab">
        <h3>Barter traders:</h3>
        <div class="input-group">
            <div class="input-group-prepend">
                <button class="btn btn-outline-secondary" type="button" id="inputBarterTraderNew">New</button>
            </div>
            <select class="custom-select" id="inputBarterTradersSelect"></select>
            <div class="input-group-append">
                <button class="btn btn-outline-secondary" type="button" id="inputBarterTraderDelete">Delete</button>
            </div>
        </div>
        <p><em>Barter trading works according to a real economic model. There is no money as an item on the server. Trading its only an exchange of things between the player and the trader. The trader's assortment consists exclusively of those items that the players have sold to him, and the prices for them are automatically regulated by the demand for a particular item by the players. The more a certain item has accumulated at the trader, the lower the price for it. Each trader has their own items storage. This means that if there are several traders on the server, economic speculations with the resale of things are possible, which greatly expands the economic opportunities of the players.</em></p>
        <p><em>Server administrators can trade with a trader ignoring the rules of market trading (buy and sell items without satisfying the barter requirements). Administrators also ignore trader filters and restrictions.</em></p>
        <br>
        <h5>Barter trader parameters:</h5>
        <div class="form-group row">
            <label for="inputBarterTraderName" class="col-sm-2 col-form-label">Name:</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="inputBarterTraderName" required>
                <p><em>Displayed only in the admin panel.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputBarterTraderClassname" class="col-sm-2 col-form-label">Classname:</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="inputBarterTraderClassname" required>
                <p><em>The classname of the object in the game that will act as a barter trader. The trader can be a character or an item.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputBarterTraderAttachments" class="col-sm-2 col-form-label">Attachments:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputBarterTraderAttachments"></textarea>
                <p><em>List of items that will be placed in the attachment slots of the trader.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputBarterTraderPosition" class="col-sm-2 col-form-label">Position:</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" onchange="validateVectorInput(this)" id="inputBarterTraderPosition" required>
                <p><em>The position (XYZ coordinates) of the trader in the game.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputBarterTraderRotation" class="col-sm-2 col-form-label">Rotation angle:</label>
            <div class="col-sm-10">
                <input type="number" min="0" max="360" step="any" class="form-control" id="inputBarterTraderRotation" onchange="validateNumberInput(this)" required>
                <p><em>The angle of rotation of the trader around the Y axis (In degrees from 0 to 360).</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputBarterTraderBuyFilter" class="col-sm-2 col-form-label">Filter items to buy:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputBarterTraderBuyFilter"></textarea>
                <p><em>A filter that allows you to set a list of items that a player can buy from a trader. It is allowed to use a base class to define a subset of items to buy. Using the "!" before classname allows you to deny certain items allowed by previous filters.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputBarterTraderSellFilter" class="col-sm-2 col-form-label">Filter items to sell:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputBarterTraderSellFilter"></textarea>
                <p><em>A filter that allows you to set a list of items that a player can sell to a trader. It is allowed to use a base class to define a subset of items to sell. Using the "!" before classname allows you to deny certain items allowed by previous filters.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputBarterTraderStorageMaxSize" class="col-sm-2 col-form-label">Storage size:</label>
            <div class="col-sm-10">
                <input type="number" min="10" max="1000000" step="1" class="form-control" id="inputBarterTraderStorageMaxSize" onchange="validateNumberInput(this)" required>
                <p><em>The maximum number of slots allocated to the trader for the internal storage for every item type. This storage is not an inventory in the usual sense, so big values is safe and this parameter will NOT provide to an increase server loading.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputBarterTraderStorageCommission" class="col-sm-2 col-form-label">Transaction commission:</label>
            <div class="col-sm-10">
                <input type="number" min="0" max="0.9" step="any" class="form-control" id="inputBarterTraderStorageCommission" onchange="validateNumberInput(this)" required>
                <p><em>The commission charged by the trader for each barter transaction. A value of 0 means no commission. A value of 0.5 means that the trader will take 50% of the transaction for himself, making it less profitable for the player (The player should give out 2 times more items to close the deal).</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputBarterTraderDumpingByAmountModifier" class="col-sm-2 col-form-label">Price dumping by stored items amount:</label>
            <div class="col-sm-10">
                <input type="number" min="0.0001" max="1" step="any" class="form-control" id="inputBarterTraderDumpingByAmountModifier" onchange="validateNumberInput(this)" required>
                <p><em>This parameter determines how the price of the items will fall as it accumulates in the trader's storage. Lower value of this parameter, the more price will fall as the trader's storage is filled. A value of 1 disables the prices fall.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputBarterTraderDumpingByBadQuality" class="col-sm-2 col-form-label">Price dumping by bad items condition:</label>
            <div class="col-sm-10">
                <input type="number" min="0.01" max="1" step="any" class="form-control" id="inputBarterTraderDumpingByBadQuality" onchange="validateNumberInput(this)" required>
                <p><em>This value determines how much the price of the product will fall if it is damaged. The trader does not buy destroyed or ruined items, rotten food and etc. A value of 1 disables the fall of prices for damaged items. With a value of 0.5, the trader will buy item at half price.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputBarterTraderSellMaxQuantityPercent" class="col-sm-2 col-form-label">Max items quantity per transaction for sale:</label>
            <div class="col-sm-10">
                <input type="number" min="0.0001" max="1" step="any" class="form-control" id="inputBarterTraderSellMaxQuantityPercent" onchange="validateNumberInput(this)" required>
                <p><em>The maximum number of items that a player can sell to a trader in one operation (Value in range from 0 to 1 relative to the size of the storage). Low values of this parameter do not allow players to sell big amount of items to the trader at inflated prices calculated before the dumping caused by the filling of the storage.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputBarterTraderBuyMaxQuantityPercent" class="col-sm-2 col-form-label">Max items quantity per transaction for buy:</label>
            <div class="col-sm-10">
                <input type="number" min="0.0001" max="1" step="any" class="form-control" id="inputBarterTraderBuyMaxQuantityPercent" onchange="validateNumberInput(this)" required>
                <p><em>The maximum number of items that a player can buy from a trader in one operation (Value in range from 0 to 1 relative to the size of the storage). Low values of this parameter do not allow players to buy big amount of items from the trader at discounted prices calculated before the dumping caused by the filling of the storage.</em></p>
            </div>
        </div>
        <div class="alert" role="alert" style="visibility: hidden" id="alertMessageBarterTraders"></div>
        <button type="button" class="btn btn-primary btn-lg" wid onclick="savePageSettings(getBarterTradersDataObject(), '#alertMessageBarterTraders')">Save</button>
        <script>
            var currentBarterTraderId = -1;
            var barterTradersDataobject = JSON.parse('#{m_tradingConfig}')['m_traders'];

            function getBarterTradersDataObject() {
                return {
                    m_tradingConfig: {
                        m_traders: barterTradersDataobject
                    }
                };
            }

            function initializeBarterTradersSelection() {
                $('#inputBarterTradersSelect').html('');
                for (var i = 0; i < barterTradersDataobject.length; i++) {
                    let barterTraderObject = barterTradersDataobject[i];
                    $('#inputBarterTradersSelect').append('<option value="' + i + '" ' + (i == (barterTradersDataobject.length - 1) ? 'selected' : '') + '>' + barterTraderObject['m_displayName'] + '</option>');
                }
            }

            initializeBarterTradersSelection();

            $('#inputBarterTradersSelect').change(function () {
                let inputs = '#inputBarterTraderName,#inputBarterTraderClassname,#inputBarterTraderAttachments,#inputBarterTraderPosition,#inputBarterTraderRotation,' +
                    '#inputBarterTraderBuyFilter,#inputBarterTraderSellFilter,#inputBarterTraderStorageMaxSize,#inputBarterTraderStorageCommission,' +
                    '#inputBarterTraderDumpingByAmountModifier,#inputBarterTraderDumpingByBadQuality,#inputBarterTraderSellMaxQuantityPercent,#inputBarterTraderBuyMaxQuantityPercent';

                let barterTraderId = $(this).val() != undefined ? parseInt($(this).val()) : -1;
                if (barterTraderId != -1) {
                    $(inputs).prop("disabled", false);

                    let barterTrader = barterTradersDataobject[barterTraderId];
                    $('#inputBarterTraderName').val(barterTrader['m_displayName']);
                    $('#inputBarterTraderClassname').val(barterTrader['m_classname']);
                    $('#inputBarterTraderAttachments').val(barterTrader['m_attachments'].join('\n'));
                    $('#inputBarterTraderPosition').val(barterTrader['m_position'][0] + ' ' + barterTrader['m_position'][1] + ' ' + barterTrader['m_position'][2]);
                    $('#inputBarterTraderRotation').val(barterTrader['m_rotation']);
                    $('#inputBarterTraderBuyFilter').val(barterTrader['m_buyFilter'].join('\n'));
                    $('#inputBarterTraderSellFilter').val(barterTrader['m_sellFilter'].join('\n'));
                    $('#inputBarterTraderStorageMaxSize').val(barterTrader['m_storageMaxSize']);
                    $('#inputBarterTraderStorageCommission').val(barterTrader['m_storageCommission']);
                    $('#inputBarterTraderDumpingByAmountModifier').val(barterTrader['m_dumpingByAmountModifier']);
                    $('#inputBarterTraderDumpingByBadQuality').val(barterTrader['m_dumpingByBadQuality']);
                    $('#inputBarterTraderSellMaxQuantityPercent').val(barterTrader['m_sellMaxQuantityPercent']);
                    $('#inputBarterTraderBuyMaxQuantityPercent').val(barterTrader['m_buyMaxQuantityPercent']);
                }
                else {
                    $(inputs).val('');
                    $(inputs).prop("disabled", true);
                }

                currentBarterTraderId = barterTraderId;
            });

            $('#inputBarterTraderName').change(function () {
                if (currentBarterTraderId != -1) {
                    barterTradersDataobject[currentBarterTraderId]['m_displayName'] = $(this).val();
                    $('#inputBarterTradersSelect').find('option[value="' + currentBarterTraderId + '"]').text($(this).val());
                }
            });
            $('#inputBarterTraderClassname').change(function () { if (currentBarterTraderId != -1) barterTradersDataobject[currentBarterTraderId]['m_classname'] = $(this).val(); });
            $('#inputBarterTraderAttachments').change(function () { if (currentBarterTraderId != -1) barterTradersDataobject[currentBarterTraderId]['m_attachments'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputBarterTraderPosition').change(function () {
                if (currentBarterTraderId != -1) {
                    let pos = $(this).val().split(' ').map(val => parseFloat(val));
                    barterTradersDataobject[currentBarterTraderId]['m_position'] = pos;
                }
            });
            $('#inputBarterTraderRotation').change(function () { if (currentBarterTraderId != -1) barterTradersDataobject[currentBarterTraderId]['m_rotation'] = parseFloat($(this).val()); });
            $('#inputBarterTraderBuyFilter').change(function () { if (currentBarterTraderId != -1) barterTradersDataobject[currentBarterTraderId]['m_buyFilter'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputBarterTraderSellFilter').change(function () { if (currentBarterTraderId != -1) barterTradersDataobject[currentBarterTraderId]['m_sellFilter'] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputBarterTraderStorageMaxSize').change(function () { if (currentBarterTraderId != -1) barterTradersDataobject[currentBarterTraderId]['m_storageMaxSize'] = parseInt($(this).val()); });
            $('#inputBarterTraderStorageCommission').change(function () { if (currentBarterTraderId != -1) barterTradersDataobject[currentBarterTraderId]['m_storageCommission'] = parseFloat($(this).val()); });
            $('#inputBarterTraderDumpingByAmountModifier').change(function () { if (currentBarterTraderId != -1) barterTradersDataobject[currentBarterTraderId]['m_dumpingByAmountModifier'] = parseFloat($(this).val()); });
            $('#inputBarterTraderDumpingByBadQuality').change(function () { if (currentBarterTraderId != -1) barterTradersDataobject[currentBarterTraderId]['m_dumpingByBadQuality'] = parseFloat($(this).val()); });
            $('#inputBarterTraderSellMaxQuantityPercent').change(function () { if (currentBarterTraderId != -1) barterTradersDataobject[currentBarterTraderId]['m_sellMaxQuantityPercent'] = parseFloat($(this).val()); });
            $('#inputBarterTraderBuyMaxQuantityPercent').change(function () { if (currentBarterTraderId != -1) barterTradersDataobject[currentBarterTraderId]['m_buyMaxQuantityPercent'] = parseFloat($(this).val()); });

            $('#inputBarterTraderNew').click(function () {
                var maxId = 0;
                for (let trader of barterTradersDataobject) {
                    if (trader['m_traderId'] > maxId) {
                        maxId = trader['m_traderId'];
                    }
                }

                barterTradersDataobject.push({
                    m_traderId: maxId + 1,
                    m_displayName: 'Trader ' + (barterTradersDataobject.length + 1),
                    m_classname: 'SurvivorM_Boris',
                    m_attachments: [],
                    m_position: [0, 0, 0],
                    m_rotation: 0,
                    m_buyFilter: ["Inventory_Base", "DefaultWeapon", "DefaultMagazine"],
                    m_sellFilter: ["Inventory_Base", "DefaultWeapon", "DefaultMagazine", "!RDG2SmokeGrenade_ColorBase", "!M18SmokeGrenade_ColorBase"],
                    m_storageMaxSize: 1000,
                    m_storageCommission: 0.25,
                    m_dumpingByAmountAlgorithm: 'linear',
                    m_dumpingByAmountModifier: 0.01,
                    m_dumpingByBadQuality: 0.5,
                    m_sellMaxQuantityPercent: 0.1,
                    m_buyMaxQuantityPercent: 0.1,
                });

                initializeBarterTradersSelection();
                $('#inputBarterTradersSelect').change();
            });
            $('#inputBarterTraderDelete').click(function () {
                if (currentBarterTraderId != -1) {
                    if (confirm('Are you sure you want to delete current trader?')) {
                        barterTradersDataobject.remove(currentBarterTraderId);
                        initializeBarterTradersSelection();
                        $('#inputBarterTradersSelect').change();
                    }
                }
            });

            $('#inputBarterTradersSelect').change();
        </script>
    </div>
    <div class="tab-pane" id="zones" role="tabpanel" aria-labelledby="zones-tab">
        <h3>Zones:</h3>
        <div class="input-group">
            <div class="input-group-prepend">
                <button class="btn btn-outline-secondary" type="button" id="inputZoneNew">New</button>
            </div>
            <select class="custom-select" id="inputZonesSelect"></select>
            <div class="input-group-append">
                <button class="btn btn-outline-secondary" type="button" id="inputZoneDelete">Delete</button>
            </div>
        </div>
        <br>
        <h5>Zone parameters:</h5>
        <p id="inputZoneDefaultInfo"><em>Default zone applies to the whole game world and affects the player when it's not inside any other zone. You cannot delete default zone.</em></p>
        <br>
        <div class="form-group row">
            <label for="inputZoneName" class="col-sm-2 col-form-label">Name:</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="inputZoneName" required>
                <p><em>Displayed only in the admin panel.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputZonePosition" class="col-sm-2 col-form-label">Position:</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" onchange="validateVectorInput(this)" id="inputZonePosition" required>
                <p><em>The position (XYZ coordinates) of the zone in the world.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputZoneRadius" class="col-sm-2 col-form-label">Radius:</label>
            <div class="col-sm-10">
                <input type="number" min="1" max="10000" step="any" class="form-control" id="inputZoneRadius" onchange="validateNumberInput(this)" required>
                <p><em>The radius of the zone. Do not use too high values (greater 300m) for gas zones to prevent players from dropping FPS.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputZoneHeightEnable" class="col-sm-2 col-form-label">Height:</label>
            <div class="col-sm-10">
                <input type="checkbox" class="form-check-input" id="inputZoneHeightEnable">
                <input type="number" min="1" max="10000" step="any" class="form-control" id="inputZoneHeight" onchange="validateNumberInput(this)">
                <p><em>When using this parameter, the player's position in the zone is determined not by a sphere with a radius, but by a cylinder with a radius and height.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputZoneEnterMessage" class="col-sm-2 col-form-label">Zone entry message:</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="inputZoneEnterMessage" required>
                <p><em>This message will be displayed to the player is enters the zone. If there is no need to show it for player make this field empty.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputZoneLeaveMessage" class="col-sm-2 col-form-label">Zone leave message:</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="inputZoneLeaveMessage" required>
                <p><em>This message will be displayed to the player is leaving from zone. If there is no need to show it for player make this field empty.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputZoneLeaveTimer" class="col-sm-2 col-form-label">Leave timeout:</label>
            <div class="col-sm-10">
                <input type="number" min="0" max="300" step="1" class="form-control" id="inputZoneLeaveTimer" onchange="validateNumberInput(this)" required>
                <p><em>The time (in seconds) during which the player will be considered inside the zone after leaving it.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputZoneGodMode" class="col-sm-2 col-form-label">God mode:</label>
            <div class="col-sm-10">
                <input type="checkbox" class="form-check-input" id="inputZoneGodMode">
                <p><em>If this parameter is activated, players inside this zone do not take damage and become immortal. Suitable for safe-zones.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputZoneInverseDammage" class="col-sm-2 col-form-label">Inverse damage:</label>
            <div class="col-sm-10">
                <input type="checkbox" class="form-check-input" id="inputZoneInverseDammage">
                <p><em>If this parameter is activated, players inside this zone take inverted damage and injuries when attacking other survivors. This parameter does not invert damage from zombies and animals. A headshot from a weapon is fatal to both the victim and the aggressor. All kills inside this zone reporting to log. The aggressor will take full damage from other survivors until the next server restart. Suitable for PVE zones.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputZoneBlockBuildingMode" class="col-sm-2 col-form-label">Block building:</label>
            <div class="col-sm-10">
                <input type="checkbox" class="form-check-input" id="inputZoneBlockBuildingMode">
                <p><em>If this option is enabled, players inside this zone do not build any objects. Suitable for safe-zones and military-zones.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputZoneBlockInteractionWithPlayers" class="col-sm-2 col-form-label">Block interaction:</label>
            <div class="col-sm-10">
                <input type="checkbox" class="form-check-input" id="inputZoneBlockInteractionWithPlayers">
                <p><em>If this option is enabled, players inside this zone do not interact with other players (like feed or injections). Suitable for safe-zones.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputZoneGas" class="col-sm-2 col-form-label">Gas zone:</label>
            <div class="col-sm-10">
                <input type="checkbox" class="form-check-input" id="inputZoneGas">
                <p><em>There will be poison gas inside this zone. Do not set this value for areas that are too large, as this can provide to a FPS drops.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputZoneRadiation" class="col-sm-2 col-form-label">Radiation:</label>
            <div class="col-sm-10">
                <input type="number" min="0" max="100" step="any" class="form-control" id="inputZoneRadiation" onchange="validateNumberInput(this)" required>
                <p><em>Inside this zone, players will accumulate radiation. The higher the value, the stronger the radiation. (For 0 value - radiation is disabled).</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputZonePsi" class="col-sm-2 col-form-label">PSI:</label>
            <div class="col-sm-10">
                <input type="number" min="0" max="100" step="any" class="form-control" id="inputZonePsi" onchange="validateNumberInput(this)" required>
                <p><em>Inside this zone, players will be affected by the PSI emitting affecting the sanity. The higher the value, the stronger the emitting. (For a value of 0 - emitting is disabled).</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputZoneSpawnChance" class="col-sm-2 col-form-label">Spawn chance:</label>
            <div class="col-sm-10">
                <input type="number" min="0" max="1" step="any" class="form-control" id="inputZoneSpawnChance" onchange="validateNumberInput(this)" required>
                <p><em>The chance of spawn this zone. (0 - never; 1 - always; 0.5 - 50%)</em></p>
            </div>
        </div>
        <div class="alert" role="alert" style="visibility: hidden" id="alertMessageZones"></div>
        <button type="button" class="btn btn-primary btn-lg" wid onclick="savePageSettings(getZonesDataObject(), '#alertMessageZones')">Save</button>
        <script>
            var currentZoneId = undefined;
            var zonesConfig = JSON.parse('#{m_zonesConfig}');
            var zoneDefault = zonesConfig['m_defaultZone'];
            var zonesCustom = zonesConfig['m_customZones'];

            function getZonesDataObject() {
                return {
                    m_zonesConfig: zonesConfig
                };
            }

            function initializeZonesSelection(selectLast) {
                $('#inputZonesSelect').html('<option value="default"' + (selectLast ? '' : ' selected') + '>' + zoneDefault['m_displayName'] + '</option>');
                for (var i = 0; i < zonesCustom.length; i++) {
                    let zoneObject = zonesCustom[i];
                    $('#inputZonesSelect').append('<option value="' + i + '"' + ((selectLast && i == zonesCustom.length - 1) ? ' selected' : '') + '>' + zoneObject['m_displayName'] + '</option>');
                }
            }

            initializeZonesSelection(false);

            $('#inputZonesSelect').change(function () {
                let inputs = '#inputZoneName,#inputZonePosition,#inputZoneRadius,#inputZoneHeightEnable,#inputZoneHeight,#inputZoneEnterMessage,#inputZoneLeaveMessage,#inputZoneLeaveTimer,#inputZoneGodMode,#inputZoneInverseDammage,#inputZoneBlockBuildingMode,#inputZoneBlockInteractionWithPlayers,#inputZoneGas,#inputZoneRadiation,#inputZonePsi,#inputZoneSpawnChance';
                let nonDefaultInputs = '#inputZoneName,#inputZonePosition,#inputZoneRadius,#inputZoneHeightEnable,#inputZoneHeight,#inputZoneEnterMessage,#inputZoneLeaveMessage,#inputZoneLeaveTimer,#inputZoneGas,#inputZoneSpawnChance';

                let zoneId = $(this).val();
                if (zoneId != undefined) {
                    $(inputs).prop("disabled", false);

                    let zone = zoneDefault;
                    if (zoneId != 'default') {
                        zone = zonesCustom[parseInt(zoneId)];
                        $(nonDefaultInputs).prop("disabled", false);
                        $('#inputZoneDefaultInfo').css('visibility', 'hidden');
                    }
                    else {
                        $(nonDefaultInputs).prop("disabled", true);
                        $('#inputZoneDefaultInfo').css('visibility', 'visible');
                    }

                    $('#inputZoneName').val(zone['m_displayName']);
                    $('#inputZonePosition').val(zone['m_position'][0] + ' ' + zone['m_position'][1] + ' ' + zone['m_position'][2]);
                    $('#inputZoneRadius').val(zone['m_radius']);

                    $('#inputZoneHeightEnable').prop('checked', zone['m_height'] > 0);
                    $('#inputZoneHeight').val(zone['m_height'] > 0 ? zone['m_height'] : 1);
                    $('#inputZoneHeight').prop("disabled", zone['m_height'] <= 0);

                    $('#inputZoneEnterMessage').val(zone['m_enterMessage']);
                    $('#inputZoneLeaveMessage').val(zone['m_leaveMessage']);
                    $('#inputZoneLeaveTimer').val(zone['m_leaveTime']);
                    $('#inputZoneGodMode').prop('checked', zone['m_godMode'] > 0);
                    $('#inputZoneInverseDammage').prop('checked', zone['m_inverseDammage'] > 0);
                    $('#inputZoneBlockBuildingMode').prop('checked', zone['m_blockBuildingMode'] > 0);
                    $('#inputZoneBlockInteractionWithPlayers').prop('checked', zone['m_blockInteractionWithPlayers'] > 0);
                    $('#inputZoneGas').prop('checked', zone['m_gas'] > 0);
                    $('#inputZoneRadiation').val(zone['m_radiation']);
                    $('#inputZonePsi').val(zone['m_psi']);
                    $('#inputZoneSpawnChance').val(zone['m_spawnChance']);
                }
                else {
                    $(inputs).val('');
                    $(inputs).prop("disabled", true);
                }

                currentZoneId = zoneId;
            });

            $('#inputZoneName').change(function () {
                if (currentZoneId != undefined && currentZoneId != 'default') {
                    zonesCustom[parseInt(currentZoneId)]['m_displayName'] = $(this).val();
                    $('#inputZonesSelect').find('option[value="' + currentZoneId + '"]').text($(this).val());
                }
            });

            $('#inputZonePosition').change(function () {
                if (currentZoneId != undefined && currentZoneId != 'default') {
                    let pos = $(this).val().split(' ').map(val => parseFloat(val));
                    zonesCustom[parseInt(currentZoneId)]['m_position'] = pos;
                }
            });

            $('#inputZoneRadius').change(function () { if (currentZoneId != undefined && currentZoneId != 'default') zonesCustom[parseInt(currentZoneId)]['m_radius'] = parseFloat($(this).val()); });
            $('#inputZoneHeightEnable').change(function () {
                if (currentZoneId != undefined && currentZoneId != 'default') {
                    let checked = $(this).is(':checked');
                    zonesCustom[parseInt(currentZoneId)]['m_height'] = checked ? parseFloat($('#inputZoneHeight').val()) : -1;
                    $('#inputZoneHeight').prop("disabled", !checked);
                    validateNumberInput('#inputZoneHeight');
                }
            });
            $('#inputZoneHeight').change(function () { if (currentZoneId != undefined && currentZoneId != 'default') zonesCustom[parseInt(currentZoneId)]['m_height'] = $('#inputZoneHeightEnable').is(':checked') ? parseFloat($(this).val()) : -1; });

            $('#inputZoneEnterMessage').change(function () { if (currentZoneId != undefined && currentZoneId != 'default') zonesCustom[parseInt(currentZoneId)]['m_enterMessage'] = $(this).val(); });
            $('#inputZoneLeaveMessage').change(function () { if (currentZoneId != undefined && currentZoneId != 'default') zonesCustom[parseInt(currentZoneId)]['m_leaveMessage'] = $(this).val(); });
            $('#inputZoneLeaveTimer').change(function () { if (currentZoneId != undefined && currentZoneId != 'default') zonesCustom[parseInt(currentZoneId)]['m_leaveTime'] = parseInt($(this).val()); });

            $('#inputZoneGodMode').change(function () {
                if (currentZoneId != undefined) {
                    if (currentZoneId == 'default') {
                        zoneDefault['m_godMode'] = $(this).is(':checked') ? 1 : 0;
                    }
                    else {
                        zonesCustom[parseInt(currentZoneId)]['m_godMode'] = $(this).is(':checked') ? 1 : 0;
                    }
                }
            });
            $('#inputZoneInverseDammage').change(function () {
                if (currentZoneId != undefined) {
                    if (currentZoneId == 'default') {
                        zoneDefault['m_inverseDammage'] = $(this).is(':checked') ? 1 : 0;
                    }
                    else {
                        zonesCustom[parseInt(currentZoneId)]['m_inverseDammage'] = $(this).is(':checked') ? 1 : 0;
                    }
                }
            });
            $('#inputZoneBlockBuildingMode').change(function () {
                if (currentZoneId != undefined) {
                    if (currentZoneId == 'default') {
                        zoneDefault['m_blockBuildingMode'] = $(this).is(':checked') ? 1 : 0;
                    }
                    else {
                        zonesCustom[parseInt(currentZoneId)]['m_blockBuildingMode'] = $(this).is(':checked') ? 1 : 0;
                    }
                }
            });
            $('#inputZoneBlockInteractionWithPlayers').change(function () {
                if (currentZoneId != undefined) {
                    if (currentZoneId == 'default') {
                        zoneDefault['m_blockInteractionWithPlayers'] = $(this).is(':checked') ? 1 : 0;
                    }
                    else {
                        zonesCustom[parseInt(currentZoneId)]['m_blockInteractionWithPlayers'] = $(this).is(':checked') ? 1 : 0;
                    }
                }
            });

            $('#inputZoneGas').change(function () { if (currentZoneId != undefined && currentZoneId != 'default') zonesCustom[parseInt(currentZoneId)]['m_gas'] = $(this).is(':checked') ? 1 : 0; });

            $('#inputZoneRadiation').change(function () {
                if (currentZoneId != undefined) {
                    if (currentZoneId == 'default') {
                        zoneDefault['m_radiation'] = parseFloat($(this).val());
                    }
                    else {
                        zonesCustom[parseInt(currentZoneId)]['m_radiation'] = parseFloat($(this).val());
                    }
                }
            });
            $('#inputZonePsi').change(function () {
                if (currentZoneId != undefined) {
                    if (currentZoneId == 'default') {
                        zoneDefault['m_psi'] = parseFloat($(this).val());
                    }
                    else {
                        zonesCustom[parseInt(currentZoneId)]['m_psi'] = parseFloat($(this).val());
                    }
                }
            });

            $('#inputZoneSpawnChance').change(function () { if (currentZoneId != undefined && currentZoneId != 'default') zonesCustom[parseInt(currentZoneId)]['m_spawnChance'] = parseFloat($(this).val()); });


            $('#inputZoneNew').click(function () {
                var maxId = 0;
                for (let zone of zonesCustom) {
                    if (zone['m_id'] > maxId) {
                        maxId = zone['m_id'];
                    }
                }

                zonesCustom.push({
                    m_id: maxId + 1,
                    m_displayName: 'Zone ' + (zonesCustom.length + 1),
                    m_position: [0, 0, 0],
                    m_radius: 10,
                    m_height: -1,
                    m_enterMessage: '',
                    m_leaveMessage: '',
                    m_leaveTime: 0,
                    m_godMode: 0,
                    m_inverseDammage: 0,
                    m_blockBuildingMode: 0,
                    m_blockInteractionWithPlayers: 0,
                    m_radiation: 0,
                    m_psi: 0,
                    m_gas: 0,
                    m_spawnChance: 1
                });

                initializeZonesSelection(true);
                $('#inputZonesSelect').change();
            });
            $('#inputZoneDelete').click(function () {
                if (currentZoneId != undefined && currentZoneId != 'default') {
                    if (confirm('Are you sure you want to delete current zone?')) {
                        zonesCustom.remove(parseInt(currentZoneId));
                        initializeZonesSelection(false);
                        $('#inputZonesSelect').change();
                    }
                }
            });

            $('#inputZonesSelect').change();
        </script>
    </div>
    <div class="tab-pane" id="crafting" role="tabpanel" aria-labelledby="crafting-tab">
        <h3>Default crafts:</h3>
        <p><em>You can enable or disable default crafts and crafts added by another mods.</em></p>
        <div style="overflow-y: scroll; height:350px; width: auto;">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th scope="col">Craft Classname</th>
                    <th scope="col">Enabled</th>
                </tr>
            </thead>
            <tbody id="inputCraftingDefaultRecipes">
            </tbody>
        </table>
        </div>
        <br>
        <h3>Custom crafts:</h3>
        <div class="input-group">
            <div class="input-group-prepend">
                <button class="btn btn-outline-secondary" type="button" id="inputCraftingNew">New</button>
            </div>
            <select class="custom-select" id="inputCraftingsSelect"></select>
            <div class="input-group-append">
                <button class="btn btn-outline-secondary" type="button" id="inputCraftingDelete">Delete</button>
            </div>
        </div>
        <p><em>Custom crafts allow to add new recipes to the game.</em></p>
        <br>
        <h5>Craft parameters:</h5>
        <div class="form-group row">
            <label for="inputCraftingName" class="col-sm-2 col-form-label">Craft name:</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="inputCraftingName" required>
                <p><em>The name of the craft is displayed in the game and allows the player to understand what he will get as result.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputCraftingIsInstaRecipe" class="col-sm-2 col-form-label">Is instant recipe:</label>
            <div class="col-sm-10">
                <input class="form-check-input" type="checkbox" id="inputCraftingIsInstaRecipe">
                <p><em>Should this recipe be performed instantly without animation?</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputCraftingAnimationLength" class="col-sm-2 col-form-label">Crafting time:</label>
            <div class="col-sm-10">
                <input type="number" min="0" max="100000" step="any" class="form-control" id="inputCraftingAnimationLength" onchange="validateNumberInput(this)" required>
                <p><em>Crafting animation time in seconds.</em></p>
            </div>
        </div>
        <br>
        <br>
        <div class="form-group row">
            <h5 class="col-sm-2">Ingredients:</h5>
            <div class="col-sm-10">
                <div class="btn-group btn-group-toggle" data-toggle="buttons">
                    <label class="btn btn-secondary active">
                        <input type="radio" name="inputCraftingSwitchIngredient" id="inputCraftingSwitchIngredient1" autocomplete="off" x-index="0" checked> First ingredient
                    </label>
                    <label class="btn btn-secondary">
                        <input type="radio" name="inputCraftingSwitchIngredient" id="inputCraftingSwitchIngredient2" autocomplete="off" x-index="1"> Second ingredient
                    </label>
                </div>
            </div>
        </div>
        <br>
        <div class="form-group row">
            <label for="inputCraftingIngredientItems" class="col-sm-2 col-form-label">Items:</label>
            <div class="col-sm-10">
                <textarea class="form-control" id="inputCraftingIngredientItems"></textarea>
                <p><em>Specify one or more items to be used as the first ingredient. The classname of each item should be on a new line. It is allowed to use base classes to generalize a subset of items.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputCraftingMinQuantityIngredient" class="col-sm-2 col-form-label">Minimum quantity check:</label>
            <div class="col-sm-10">
                <input type="number" min="-1" max="1000000" step="any" class="form-control" id="inputCraftingMinQuantityIngredient" onchange="validateNumberInput(this)" required>
                <p><em>The minimum quantity of an item required for crafting. Use "-1" to disable check.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputCraftingMaxQuantityIngredient" class="col-sm-2 col-form-label">Maximum quantity check:</label>
            <div class="col-sm-10">
                <input type="number" min="-1" max="1000000" step="any" class="form-control" id="inputCraftingMaxQuantityIngredient" onchange="validateNumberInput(this)" required>
                <p><em>The maximum quantity of the item with which crafting is allowed. Use "-1" to disable check.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputCraftingMinDamageIngredient" class="col-sm-2 col-form-label">Minimum damage check:</label>
            <div class="col-sm-10">
                <select id="inputCraftingMinDamageIngredient" class="form-select">
                    <option value="-1">Disable check</option>
                    <option value="0">Pristine</option>
                    <option value="1">Worn</option>
                    <option value="2">Damaged</option>
                    <option value="3">Badly damaged</option>
                    <option value="4">Ruined</option>
                </select>
                <p><em>The minimum damage level of an item required for crafting.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputCraftingMaxDamageIngredient" class="col-sm-2 col-form-label">Maximum damage check:</label>
            <div class="col-sm-10">
                <select id="inputCraftingMaxDamageIngredient" class="form-select">
                    <option value="-1">Disable check</option>
                    <option value="0">Pristine</option>
                    <option value="1">Worn</option>
                    <option value="2">Damaged</option>
                    <option value="3">Badly damaged</option>
                    <option value="4">Ruined</option>
                </select>
                <p><em>The maximum damage of the item with which crafting is allowed.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputCraftingHealthActionSelect" class="col-sm-2 col-form-label">Damage action:</label>
            <div class="col-sm-10">
                <select id="inputCraftingHealthActionSelect" class="form-select">
                    <option value="0">None</option>
                    <option value="1">Increase health</option>
                    <option value="2">Set health</option>
                    <option value="3">Decrease health</option>
                </select>
                <input type="number" min="0" max="1000000" step="any" class="form-control" id="inputCraftingHealthActionValue" onchange="validateNumberInput(this)" required>
                <p><em>Action on ingredient item health after crafting.</em></p>
            </div>
        </div>
        <div class="form-group row">
            <label for="inputCraftingQuantityActionSelect" class="col-sm-2 col-form-label">Quantity action:</label>
            <div class="col-sm-10">
                <select id="inputCraftingQuantityActionSelect" class="form-select">
                    <option value="0">None</option>
                    <option value="1">Increase quantity</option>
                    <option value="2">Decrease quantity</option>
                    <option value="3">Destroy item</option>
                </select>
                <input type="number" min="0" max="1000000" step="any" class="form-control" id="inputCraftingQuantityActionValue" onchange="validateNumberInput(this)" required>
                <p><em>Action on ingredient item quantity after crafting. Use "Destroy item" if the crafting ingredient should be destroyed after crafting.</em></p>
            </div>
        </div>

        <h5>Crafting result:</h5>
        <div class="form-group row">
            <div class="col-sm-10 input-group-btn">
                <div class="input-group-prepend">
                    <button class="btn btn-outline-secondary" type="button" id="inputCraftingResultsNew">Add</button>
                    <select class="form-control custom-select" id="inputCraftingResults"></select>
                    <button class="btn btn-outline-secondary" type="button" id="inputCraftingResultsDelete">Remove</button>
                </div>
                <p><em>A list of items and their condition that the player will get as a result of crafting. Can be empty.</em></p>
                <div class="row" style="margin-top: 20px">
                    <label for="inputCraftingResultsClassname" class="col-sm-2 col-form-label">Item:</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="inputCraftingResultsClassname" required>
                        <p><em>The classname of resulted item.</em></p>
                    </div>
                </div>
                <div class="row" style="margin-top: 20px">
                    <label for="inputCraftingResultQuantityActionSelect" class="col-sm-2 col-form-label">Quantity action:</label>
                    <div class="col-sm-10">
                        <select id="inputCraftingResultQuantityActionSelect" class="form-select">
                            <option value="0" selected>None</option>
                            <option value="1">Set quantity</option>
                            <option value="2">Set full quantity</option>
                        </select>
                        <input type="number" min="0" max="1000000" step="any" class="form-control" id="inputCraftingResultQuantityActionValue" onchange="validateNumberInput(this)" required>
                    </div>
                </div>
                <div class="row" style="margin-top: 20px">
                    <label for="inputCraftingResultHealthActionSelect" class="col-sm-2 col-form-label">Health action:</label>
                    <div class="col-sm-10">
                        <select id="inputCraftingResultHealthActionSelect" class="form-select">
                            <option value="0" selected>None</option>
                            <option value="1">Set health</option>
                            <option value="2">Inherit health</option>
                        </select>
                        <input type="number" min="0" max="1000000" step="any" class="form-control" id="inputCraftingResultHealthActionValue1" onchange="validateNumberInput(this)" required>
                        <select id="inputCraftingResultHealthActionValue2" class="form-select">
                            <option value="0" selected>First ingredient</option>
                            <option value="1">Second ingredient</option>
                            <option value="-2">Average of all ingredients</option>
                        </select>
                    </div>
                </div>
                <div class="row" style="margin-top: 20px">
                    <label for="inputCraftingResultToInventorySelect" class="col-sm-2 col-form-label">Result destination:</label>
                    <div class="col-sm-10">
                        <select id="inputCraftingResultToInventorySelect" class="form-select">
                            <option value="0" selected>On ground</option>
                            <option value="-1">In inventory</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <div class="alert" role="alert" style="visibility: hidden" id="alertMessageCraftings"></div>
        <button type="button" class="btn btn-primary btn-lg" wid onclick="savePageSettings(getCraftingsDataObject(), '#alertMessageCraftings')">Save</button>
        <script>
            var currentCraftingId = -1;
            var currentCraftingIngredientId = 0;
            var currentCraftingResultId = -1;
            var craftingConfig = JSON.parse('#{m_craftingConfig}');
            var craftingsDataobject = craftingConfig['m_customRecipes'];

            for (var i = 0; i < craftingConfig['m_allDefaultRecipes'].length; i++) {
                let checkedState = craftingConfig['m_disabledDefaultRecipes'].some(x => x === craftingConfig['m_allDefaultRecipes'][i]) ? '' : 'checked';
                $('#inputCraftingDefaultRecipes').append('<tr><th>' + craftingConfig['m_allDefaultRecipes'][i] + '</th><td><input type="checkbox" x-name="' + craftingConfig['m_allDefaultRecipes'][i] + '" ' + checkedState + '/></td></tr>');
            }

            $('#inputCraftingDefaultRecipes').find('input[x-name]').change(function () {
                let name = $(this).attr('x-name');
                var index = craftingConfig['m_disabledDefaultRecipes'].indexOf(name);
                if (index != -1) {
                    craftingConfig['m_disabledDefaultRecipes'].remove(index);
                }

                if ($(this).is(':checked') == false) {
                    craftingConfig['m_disabledDefaultRecipes'].push(name);
                }
            });

            function getCraftingsDataObject() {
                return {
                    m_craftingConfig: craftingConfig
                };
            }

            function initializeCraftingsSelection() {
                $('#inputCraftingsSelect').html('');
                for (var i = 0; i < craftingsDataobject.length; i++) {
                    let craftingObject = craftingsDataobject[i];
                    $('#inputCraftingsSelect').append('<option value="' + i + '" ' + (i == (craftingsDataobject.length - 1) ? 'selected' : '') + '>' + craftingObject['m_Name'] + '</option>');
                }
            }

            function initializeCraftingsIngredient(craftingData) {
                $('#inputCraftingIngredientItems').val(craftingData['m_Ingredients'][currentCraftingIngredientId].join('\n'));
                $('#inputCraftingMinQuantityIngredient').val(craftingData['m_MinQuantityIngredient'][currentCraftingIngredientId]);
                $('#inputCraftingMaxQuantityIngredient').val(craftingData['m_MaxQuantityIngredient'][currentCraftingIngredientId]);

                $('#inputCraftingMinDamageIngredient').find('option[value="' + craftingData['m_MinDamageIngredient'][currentCraftingIngredientId] + '"]').prop('selected', true);
                $('#inputCraftingMaxDamageIngredient').find('option[value="' + craftingData['m_MaxDamageIngredient'][currentCraftingIngredientId] + '"]').prop('selected', true);

                if (craftingData['m_IngredientAddHealth'][currentCraftingIngredientId] > 0) {
                    $('#inputCraftingHealthActionSelect').find('option[value="1"]').prop('selected', true);
                    $('#inputCraftingHealthActionValue').val(craftingData['m_IngredientAddHealth'][currentCraftingIngredientId]);
                    $('#inputCraftingHealthActionValue').prop("disabled", false);
                }
                else if (craftingData['m_IngredientAddHealth'][currentCraftingIngredientId] < 0) {
                    $('#inputCraftingHealthActionSelect').find('option[value="3"]').prop('selected', true);
                    $('#inputCraftingHealthActionValue').val(craftingData['m_IngredientAddHealth'][currentCraftingIngredientId] * -1);
                    $('#inputCraftingHealthActionValue').prop("disabled", false);
                }
                else if (craftingData['m_IngredientSetHealth'][currentCraftingIngredientId] >= 0) {
                    $('#inputCraftingHealthActionSelect').find('option[value="2"]').prop('selected', true);
                    $('#inputCraftingHealthActionValue').val(craftingData['m_IngredientSetHealth'][currentCraftingIngredientId]);
                    $('#inputCraftingHealthActionValue').prop("disabled", false);
                }
                else {
                    $('#inputCraftingHealthActionSelect').find('option[value="0"]').prop('selected', true);
                    $('#inputCraftingHealthActionValue').val('');
                    $('#inputCraftingHealthActionValue').prop("disabled", true);
                }

                if (craftingData['m_IngredientDestroy'][currentCraftingIngredientId] == 1) {
                    $('#inputCraftingQuantityActionSelect').find('option[value="3"]').prop('selected', true);
                    $('#inputCraftingQuantityActionValue').val('');
                    $('#inputCraftingQuantityActionValue').prop("disabled", true);
                }
                else if (craftingData['m_IngredientAddQuantity'][currentCraftingIngredientId] > 0) {
                    $('#inputCraftingQuantityActionSelect').find('option[value="1"]').prop('selected', true);
                    $('#inputCraftingQuantityActionValue').val(craftingData['m_IngredientAddQuantity'][currentCraftingIngredientId]);
                    $('#inputCraftingQuantityActionValue').prop("disabled", false);
                }
                else if (craftingData['m_IngredientAddQuantity'][currentCraftingIngredientId] < 0) {
                    $('#inputCraftingQuantityActionSelect').find('option[value="2"]').prop('selected', true);
                    $('#inputCraftingQuantityActionValue').val(craftingData['m_IngredientAddQuantity'][currentCraftingIngredientId] * -1);
                    $('#inputCraftingQuantityActionValue').prop("disabled", false);
                }
                else {
                    $('#inputCraftingQuantityActionSelect').find('option[value="0"]').prop('selected', true);
                    $('#inputCraftingQuantityActionValue').val('');
                    $('#inputCraftingQuantityActionValue').prop("disabled", true);
                }
            }

            function initializeCraftingsResultSelection(craftingData) {
                $('#inputCraftingResults').html('');
                for (var i = 0; i < craftingData['m_ItemsToCreate'].length && i < 10; i++) {
                    $('#inputCraftingResults').append('<option value="' + i + '" ' + (i == (craftingData['m_ItemsToCreate'].length - 1) ? 'selected' : '') + '>Result #' + i + ": " + craftingData['m_ItemsToCreate'][i] + '</option>');
                }
            }

            initializeCraftingsSelection();

            $('#inputCraftingsSelect').change(function () {
                let inputs = '#inputCraftingName,#inputCraftingIsInstaRecipe,#inputCraftingAnimationLength,' +
                    '#inputCraftingIngredientItems,#inputCraftingMinQuantityIngredient,#inputCraftingMaxQuantityIngredient,' +
                    '#inputCraftingMinDamageIngredient,#inputCraftingMaxDamageIngredient,#inputCraftingHealthActionSelect,#inputCraftingHealthActionValue,' +
                    '#inputCraftingQuantityActionSelect,#inputCraftingQuantityActionValue,#inputCraftingResults,#inputCraftingResultsNew,#inputCraftingResultsDelete,' +
                    '#inputCraftingResultsClassname,#inputCraftingResultQuantityActionSelect,#inputCraftingResultQuantityActionValue,#inputCraftingResultHealthActionSelect,' +
                    '#inputCraftingResultHealthActionValue1,#inputCraftingResultHealthActionValue2,#inputCraftingResultToInventorySelect';
                $('#inputCraftingResults').html('');

                let craftingId = $(this).val() != undefined ? parseInt($(this).val()) : -1;
                if (craftingId != -1) {
                    $(inputs).prop("disabled", false);

                    let crafting = craftingsDataobject[craftingId];
                    $('#inputCraftingName').val(crafting['m_Name']);
                    $('#inputCraftingIsInstaRecipe').prop('checked', crafting['m_IsInstaRecipe'] == 1);
                    $('#inputCraftingAnimationLength').val(crafting['m_AnimationLength']);

                    initializeCraftingsIngredient(crafting);
                    initializeCraftingsResultSelection(crafting);
                }
                else {
                    $(inputs).val('');
                    $(inputs).prop("disabled", true);
                }

                currentCraftingId = craftingId;
                $('#inputCraftingResults').change();
            });

            $('#inputCraftingResults').change(function () {
                let inputs = '#inputCraftingResultsClassname,#inputCraftingResultQuantityActionSelect,#inputCraftingResultQuantityActionValue,#inputCraftingResultHealthActionSelect,' +
                    '#inputCraftingResultHealthActionValue1,#inputCraftingResultHealthActionValue2,#inputCraftingResultToInventorySelect';

                let craftingResultId = $(this).val() != undefined ? parseInt($(this).val()) : -1;
                if (craftingResultId != -1 && currentCraftingId != -1) {
                    $(inputs).prop("disabled", false);

                    let crafting = craftingsDataobject[currentCraftingId];
                    $('#inputCraftingResultsClassname').val(crafting['m_ItemsToCreate'][craftingResultId]);

                    if (crafting['m_ResultSetFullQuantity'][craftingResultId] == 1) {
                        $('#inputCraftingResultQuantityActionSelect').find('option[value="2"]').prop('selected', true);
                        $('#inputCraftingResultQuantityActionValue').prop("disabled", true);
                    }
                    else if (crafting['m_ResultSetQuantity'][craftingResultId] != -1) {
                        $('#inputCraftingResultQuantityActionSelect').find('option[value="1"]').prop('selected', true);
                        $('#inputCraftingResultQuantityActionValue').val(crafting['m_ResultSetQuantity'][craftingResultId]);
                        $('#inputCraftingResultQuantityActionValue').prop("disabled", false);
                    }
                    else {
                        $('#inputCraftingResultQuantityActionSelect').find('option[value="0"]').prop('selected', true);
                        $('#inputCraftingResultQuantityActionValue').prop("disabled", true);
                    }

                    if (crafting['m_ResultInheritsHealth'][craftingResultId] != -1) {
                        $('#inputCraftingResultHealthActionSelect').find('option[value="2"]').prop('selected', true);
                        $('#inputCraftingResultHealthActionValue1').hide();
                        $('#inputCraftingResultHealthActionValue2').show();
                        $('#inputCraftingResultHealthActionValue2').find('option[value="' + crafting['m_ResultInheritsHealth'][craftingResultId] + '"]').prop('selected', true);
                    }
                    else if (crafting['m_ResultSetHealth'][craftingResultId] != -1) {
                        $('#inputCraftingResultHealthActionSelect').find('option[value="1"]').prop('selected', true);
                        $('#inputCraftingResultHealthActionValue2').hide();
                        $('#inputCraftingResultHealthActionValue1').show();
                        $('#inputCraftingResultHealthActionValue1').val(crafting['m_ResultSetHealth'][craftingResultId]);
                    }
                    else {
                        $('#inputCraftingResultHealthActionSelect').find('option[value="0"]').prop('selected', true);
                        $('#inputCraftingResultHealthActionValue1').hide();
                        $('#inputCraftingResultHealthActionValue2').hide();
                    }

                    $('#inputCraftingResultToInventorySelect').find('option[value="' + crafting['m_ResultToInventory'][craftingResultId] + '"]').prop('selected', true);
                }
                else {
                    $(inputs).val('');
                    $(inputs).prop("disabled", true);
                }

                currentCraftingResultId = craftingResultId;
            });

            $('#inputCraftingName').change(function () {
                if (currentCraftingId != -1) {
                    craftingsDataobject[currentCraftingId]['m_Name'] = $(this).val();
                    $('#inputCraftingsSelect').find('option[value="' + currentCraftingId + '"]').text($(this).val());
                }
            });
            $('#inputCraftingIsInstaRecipe').change(function () { if (currentCraftingId != -1) craftingsDataobject[currentCraftingId]['m_IsInstaRecipe'] = $(this).is(':checked') ? 1 : 0; });
            $('#inputCraftingAnimationLength').change(function () { if (currentCraftingId != -1) craftingsDataobject[currentCraftingId]['m_AnimationLength'] = parseFloat($(this).val()); });

            $('#inputCraftingIngredientItems').change(function () { if (currentCraftingId != -1) craftingsDataobject[currentCraftingId]['m_Ingredients'][currentCraftingIngredientId] = $(this).val().split('\n').filter(n => n.trim()); });
            $('#inputCraftingMinQuantityIngredient').change(function () { if (currentCraftingId != -1) craftingsDataobject[currentCraftingId]['m_MinQuantityIngredient'][currentCraftingIngredientId] = parseFloat($(this).val()); });
            $('#inputCraftingMaxQuantityIngredient').change(function () { if (currentCraftingId != -1) craftingsDataobject[currentCraftingId]['m_MaxQuantityIngredient'][currentCraftingIngredientId] = parseFloat($(this).val()); });

            $('#inputCraftingMinDamageIngredient').change(function () {
                if (currentCraftingId != -1) {
                    let selectionId = $(this).val() != undefined ? parseInt($(this).val()) : -1;
                    craftingsDataobject[currentCraftingId]['m_MinDamageIngredient'][currentCraftingIngredientId] = selectionId;
                }
            });

            $('#inputCraftingMaxDamageIngredient').change(function () {
                if (currentCraftingId != -1) {
                    let selectionId = $(this).val() != undefined ? parseInt($(this).val()) : -1;
                    craftingsDataobject[currentCraftingId]['m_MaxDamageIngredient'][currentCraftingIngredientId] = selectionId;
                }
            });

            $('#inputCraftingHealthActionSelect').change(function () {
                if (currentCraftingId != -1) {
                    let selectionId = $(this).val() != undefined ? parseInt($(this).val()) : 0;

                    craftingsDataobject[currentCraftingId]['m_IngredientAddHealth'][currentCraftingIngredientId] = 0;
                    craftingsDataobject[currentCraftingId]['m_IngredientSetHealth'][currentCraftingIngredientId] = -1;

                    if (selectionId == 0) {
                        $('#inputCraftingHealthActionValue').val('');
                        $('#inputCraftingHealthActionValue').prop("disabled", true);
                    }
                    else {
                        $('#inputCraftingHealthActionValue').val('0');
                        $('#inputCraftingHealthActionValue').prop("disabled", false);
                        $('#inputCraftingHealthActionValue').change();
                    }
                }
            });

            $('#inputCraftingHealthActionValue').change(function () {
                if (currentCraftingId != -1) {
                    let selectionId = $('#inputCraftingHealthActionSelect').val() != undefined ? parseInt($('#inputCraftingHealthActionSelect').val()) : 0;
                    if (selectionId == 1) {
                        craftingsDataobject[currentCraftingId]['m_IngredientAddHealth'][currentCraftingIngredientId] = parseFloat($(this).val());
                        craftingsDataobject[currentCraftingId]['m_IngredientSetHealth'][currentCraftingIngredientId] = -1;
                    }
                    else if (selectionId == 3) {
                        craftingsDataobject[currentCraftingId]['m_IngredientAddHealth'][currentCraftingIngredientId] = parseFloat($(this).val()) * -1;
                        craftingsDataobject[currentCraftingId]['m_IngredientSetHealth'][currentCraftingIngredientId] = -1;
                    }
                    else if (selectionId == 2) {
                        craftingsDataobject[currentCraftingId]['m_IngredientAddHealth'][currentCraftingIngredientId] = 0;
                        craftingsDataobject[currentCraftingId]['m_IngredientSetHealth'][currentCraftingIngredientId] = parseFloat($(this).val());
                    }
                    else {
                        craftingsDataobject[currentCraftingId]['m_IngredientAddHealth'][currentCraftingIngredientId] = 0;
                        craftingsDataobject[currentCraftingId]['m_IngredientSetHealth'][currentCraftingIngredientId] = -1;
                    }
                }
            });

            $('#inputCraftingQuantityActionSelect').change(function () {
                if (currentCraftingId != -1) {
                    let selectionId = $(this).val() != undefined ? parseInt($(this).val()) : 0;

                    if (selectionId == 3) {
                        craftingsDataobject[currentCraftingId]['m_IngredientDestroy'][currentCraftingIngredientId] = 1;
                        craftingsDataobject[currentCraftingId]['m_IngredientAddQuantity'][currentCraftingIngredientId] = 0;
                    }
                    else {
                        craftingsDataobject[currentCraftingId]['m_IngredientDestroy'][currentCraftingIngredientId] = 0;
                        craftingsDataobject[currentCraftingId]['m_IngredientAddQuantity'][currentCraftingIngredientId] = 0;
                    }

                    if (selectionId == 0 || selectionId == 3) {
                        $('#inputCraftingQuantityActionValue').val('');
                        $('#inputCraftingQuantityActionValue').prop("disabled", true);
                    }
                    else {
                        $('#inputCraftingQuantityActionValue').val('0');
                        $('#inputCraftingQuantityActionValue').prop("disabled", false);
                        $('#inputCraftingQuantityActionValue').change();
                    }
                }
            });

            $('#inputCraftingQuantityActionValue').change(function () {
                if (currentCraftingId != -1) {
                    let selectionId = $('#inputCraftingQuantityActionSelect').val() != undefined ? parseInt($('#inputCraftingQuantityActionSelect').val()) : 0;
                    if (selectionId == 3) {
                        craftingsDataobject[currentCraftingId]['m_IngredientDestroy'][currentCraftingIngredientId] = 1;
                        craftingsDataobject[currentCraftingId]['m_IngredientAddQuantity'][currentCraftingIngredientId] = 0;
                    }
                    else if (selectionId == 1) {
                        craftingsDataobject[currentCraftingId]['m_IngredientDestroy'][currentCraftingIngredientId] = 0;
                        craftingsDataobject[currentCraftingId]['m_IngredientAddQuantity'][currentCraftingIngredientId] = parseFloat($(this).val());
                    }
                    else if (selectionId == 2) {
                        craftingsDataobject[currentCraftingId]['m_IngredientDestroy'][currentCraftingIngredientId] = 0;
                        craftingsDataobject[currentCraftingId]['m_IngredientAddQuantity'][currentCraftingIngredientId] = parseFloat($(this).val()) * -1;
                    }
                    else {
                        craftingsDataobject[currentCraftingId]['m_IngredientDestroy'][currentCraftingIngredientId] = 0;
                        craftingsDataobject[currentCraftingId]['m_IngredientAddQuantity'][currentCraftingIngredientId] = 0;
                    }
                }
            });

            $("input[name='inputCraftingSwitchIngredient']:radio").on("change", function () {
                currentCraftingIngredientId = parseInt($(this).attr('x-index'));

                if (currentCraftingId != -1) {
                    initializeCraftingsIngredient(craftingsDataobject[currentCraftingId]);
                }
            });

            $('#inputCraftingResultsClassname').change(function () {
                if (currentCraftingId != -1 && currentCraftingResultId != -1) {
                    craftingsDataobject[currentCraftingId]['m_ItemsToCreate'][currentCraftingResultId] = $(this).val();
                    $('#inputCraftingResults').find('option[value="' + currentCraftingResultId + '"]').text('Result #' + currentCraftingResultId + ': ' + $(this).val());
                }
            });

            $('#inputCraftingResultQuantityActionSelect').change(function () {
                if (currentCraftingId != -1 && currentCraftingResultId != -1) {
                    let selectionId = $(this).val() != undefined ? parseInt($(this).val()) : 0;

                    craftingsDataobject[currentCraftingId]['m_ResultSetFullQuantity'][currentCraftingResultId] = 0;
                    craftingsDataobject[currentCraftingId]['m_ResultSetQuantity'][currentCraftingResultId] = -1;

                    if (selectionId == 0 || selectionId == 2) {
                        $('#inputCraftingResultQuantityActionValue').val('');
                        $('#inputCraftingResultQuantityActionValue').prop("disabled", true);
                    }
                    else {
                        $('#inputCraftingResultQuantityActionValue').val('0');
                        $('#inputCraftingResultQuantityActionValue').prop("disabled", false);
                        $('#inputCraftingResultQuantityActionValue').change();
                    }
                }
            });

            $('#inputCraftingResultQuantityActionValue').change(function () {
                if (currentCraftingId != -1 && currentCraftingResultId != -1) {
                    let selectionId = $('#inputCraftingResultQuantityActionSelect').val() != undefined ? parseInt($('#inputCraftingResultQuantityActionSelect').val()) : 0;
                    if (selectionId == 1) {
                        craftingsDataobject[currentCraftingId]['m_ResultSetFullQuantity'][currentCraftingResultId] = 0;
                        craftingsDataobject[currentCraftingId]['m_ResultSetQuantity'][currentCraftingResultId] = parseFloat($(this).val());
                    }
                    else if (selectionId == 2) {
                        craftingsDataobject[currentCraftingId]['m_ResultSetFullQuantity'][currentCraftingResultId] = 1;
                        craftingsDataobject[currentCraftingId]['m_ResultSetQuantity'][currentCraftingResultId] = -1;
                    }
                    else {
                        craftingsDataobject[currentCraftingId]['m_ResultSetFullQuantity'][currentCraftingResultId] = 0;
                        craftingsDataobject[currentCraftingId]['m_ResultSetQuantity'][currentCraftingResultId] = -1;
                    }
                }
            });

            $('#inputCraftingResultHealthActionSelect').change(function () {
                if (currentCraftingId != -1 && currentCraftingResultId != -1) {
                    let selectionId = $(this).val() != undefined ? parseInt($(this).val()) : 0;

                    craftingsDataobject[currentCraftingId]['m_ResultSetHealth'][currentCraftingResultId] = -1;
                    craftingsDataobject[currentCraftingId]['m_ResultInheritsHealth'][currentCraftingResultId] = -1;

                    if (selectionId == 1) {
                        $('#inputCraftingResultHealthActionValue2').hide();
                        $('#inputCraftingResultHealthActionValue1').show();
                        $('#inputCraftingResultHealthActionValue1').val('0');
                        $('#inputCraftingResultHealthActionValue1').change();
                    }
                    else if (selectionId == 2) {
                        $('#inputCraftingResultHealthActionValue1').hide();
                        $('#inputCraftingResultHealthActionValue2').show();
                        $('#inputCraftingResultHealthActionValue2').find('option[value="0"]').prop('selected', true);
                        $('#inputCraftingResultHealthActionValue2').change();
                    }
                    else {
                        $('#inputCraftingResultHealthActionValue1').hide();
                        $('#inputCraftingResultHealthActionValue2').hide();
                    }
                }
            });

            $('#inputCraftingResultHealthActionValue1').change(function () {
                if (currentCraftingId != -1 && currentCraftingResultId != -1) {
                    craftingsDataobject[currentCraftingId]['m_ResultSetHealth'][currentCraftingResultId] = parseFloat($(this).val());
                    craftingsDataobject[currentCraftingId]['m_ResultInheritsHealth'][currentCraftingResultId] = -1;
                }
            });

            $('#inputCraftingResultHealthActionValue2').change(function () {
                if (currentCraftingId != -1 && currentCraftingResultId != -1) {
                    let selectionId = $(this).val() != undefined ? parseInt($(this).val()) : 0;
                    craftingsDataobject[currentCraftingId]['m_ResultSetHealth'][currentCraftingResultId] = -1;
                    craftingsDataobject[currentCraftingId]['m_ResultInheritsHealth'][currentCraftingResultId] = selectionId;
                }
            });

            $('#inputCraftingResultToInventorySelect').change(function () {
                if (currentCraftingId != -1 && currentCraftingResultId != -1) {
                    let selectionId = $(this).val() != undefined ? parseInt($(this).val()) : 0;
                    craftingsDataobject[currentCraftingId]['m_ResultToInventory'][currentCraftingResultId] = selectionId;
                }
            });

            $('#inputCraftingNew').click(function () {
                craftingsDataobject.push({
                    m_Name: 'Crafting ' + (craftingsDataobject.length + 1),
                    m_IsInstaRecipe: 0,
                    m_AnimationLength: 1,

                    m_Ingredients: [[], []],
                    m_MinQuantityIngredient: [-1, -1],
                    m_MaxQuantityIngredient: [-1, -1],
                    m_MinDamageIngredient: [-1, -1],
                    m_MaxDamageIngredient: [-1, -1],
                    m_IngredientAddHealth: [0, 0],
                    m_IngredientAddQuantity: [0, 0],
                    m_IngredientSetHealth: [-1, -1],
                    m_IngredientDestroy: [1, 1],

                    m_ResultSetFullQuantity: [],
                    m_ResultSetQuantity: [],
                    m_ResultSetHealth: [],
                    m_ResultToInventory: [],
                    m_ResultInheritsHealth: [],
                    m_ItemsToCreate: [],
                });

                initializeCraftingsSelection();
                $('#inputCraftingsSelect').change();
            });
            $('#inputCraftingDelete').click(function () {
                if (currentCraftingId != -1) {
                    if (confirm('Are you sure you want to delete current custom crafting?')) {
                        craftingsDataobject.remove(currentCraftingId);
                        initializeCraftingsSelection();
                        $('#inputCraftingsSelect').change();
                    }
                }
            });

            $('#inputCraftingResultsNew').click(function () {
                if (currentCraftingId != -1 && craftingsDataobject[currentCraftingId]['m_ItemsToCreate'].length < 10) {
                    craftingsDataobject[currentCraftingId]['m_ItemsToCreate'].push('');
                    craftingsDataobject[currentCraftingId]['m_ResultSetFullQuantity'].push(0);
                    craftingsDataobject[currentCraftingId]['m_ResultSetQuantity'].push(-1);
                    craftingsDataobject[currentCraftingId]['m_ResultSetHealth'].push(-1);
                    craftingsDataobject[currentCraftingId]['m_ResultToInventory'].push(-1);
                    craftingsDataobject[currentCraftingId]['m_ResultInheritsHealth'].push(-1);

                    initializeCraftingsResultSelection(craftingsDataobject[currentCraftingId]);
                    $('#inputCraftingResults').change();
                }
            });
            $('#inputCraftingResultsDelete').click(function () {
                if (currentCraftingId != -1 && currentCraftingResultId != -1) {
                    if (confirm('Are you sure you want to delete current crafting result?')) {
                        craftingsDataobject[currentCraftingId]['m_ItemsToCreate'].remove(currentCraftingResultId);
                        craftingsDataobject[currentCraftingId]['m_ResultSetFullQuantity'].remove(currentCraftingResultId);
                        craftingsDataobject[currentCraftingId]['m_ResultSetQuantity'].remove(currentCraftingResultId);
                        craftingsDataobject[currentCraftingId]['m_ResultSetHealth'].remove(currentCraftingResultId);
                        craftingsDataobject[currentCraftingId]['m_ResultToInventory'].remove(currentCraftingResultId);
                        craftingsDataobject[currentCraftingId]['m_ResultInheritsHealth'].remove(currentCraftingResultId);

                        initializeCraftingsResultSelection(craftingsDataobject[currentCraftingId]);
                        $('#inputCraftingResults').change();
                    }
                }
            });

            $('#inputCraftingsSelect').change();
        </script>
    </div>
    <div class="tab-pane" id="variables" role="tabpanel" aria-labelledby="variables-tab">
        <div id="internalVariablesContentBase">
            <div class="container">
                <div class="row">
                    <div class="col text-center">
                        <div class="alert alert-warning" role="alert">DO NOT CHANGE INTERNAL VARIABLES IF YOU DON'T KNOW HOW IT WORKS!</div>
                        <br>
                        <button type="button" class="btn btn-primary btn-md" onclick="loadInternalVariablesList(this)">Load internal variables list</button>
                        <div class="alert alert-danger" role="alert" style="visibility: hidden" id="alertMessageInternalVariables"></div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            function loadInternalVariablesList(button) {
                $(button).prop("disabled", true);
                $('#internalVariablesContentBase').load("/internalVariables", userData, function (response, status, xhr) {
                    if (status == "success") {
                        console.log('Internal variables list successfully loaded.');
                    }
                    else {
                        $(button).prop("disabled", false);
                        $("#alertMessageInternalVariables").css('visibility', 'visible');
                        if (xhr.status == 0) {
                            $("#alertMessageInternalVariables").html('Service is unreachable. Please check is server running or internet connection.');
                        }
                        else {
                            $("#alertMessageInternalVariables").html('Service is temporarily unavailable.');
                        }
                    }
                });
            }
        </script>
    </div>
</div>
<script>
    function validateVectorInput(field) {
        var value = $(field).val();
        var parts = value.split(' ');
        while (parts.length < 3) {
            parts.push('0');
        }
        while (parts.length > 3) {
            parts.pop();
        }
        for (var i = 0; i < parts.length; i++) {
            var num = parseFloat(parts[i]);
            if (isNaN(num)) {
                num = 0;
            }
            parts[i] = num.toString();
        }
        $(field).val(parts[0] + ' ' + parts[1] + ' ' + parts[2]);
    }

    function validateArrayInput(field) {
        var value = $(field).val();
        var parts = value.split(' ');
        var size = parseInt($(field).attr('array-size'));
        var intCheck = $(field).attr('step') && $(field).attr('step') === '1';
        while (parts.length < size) {
            parts.push('0');
        }
        while (parts.length > size) {
            parts.pop();
        }
        for (var i = 0; i < parts.length; i++) {
            var num = parseFloat(parts[i]);
            if (isNaN(num)) {
                num = 0;
            }
            if (intCheck) {
                num = Math.round(num);
            }
            parts[i] = num.toString() ?? '0';
        }
        var result = '';
        for (var i = 0; i < size; i++) {
            if (result.length > 0) {
                result += ' ';
            }
            result += parts[i];
        }

        $(field).val(result);
    }

    function validateNumberInput(field) {
        if ($(field).attr('step') && $(field).attr('step') === '1') {
            $(field).val(Math.round(parseFloat($(field).val())));
        }
        if ($(field).attr('min') && $(field).val() < parseFloat($(field).attr('min'))) {
            $(field).val(parseFloat($(field).attr('min')));
        }
        if ($(field).attr('max') && $(field).val() > parseFloat($(field).attr('max'))) {
            $(field).val(parseFloat($(field).attr('max')));
        }
        if ($(field).attr('pattern') && new RegExp($(field).attr('pattern')).test($(field).val()) === false) {
            $(field).val($(field).attr('min') ? $(field).attr('min') : 0);
        }
    }

    function savePageSettings(dataObject, alertMessage) {
        var requestData = {
            auth: userData,
            data: dataObject
        };

        $.post("/save", JSON.stringify(requestData), function (data) {
            $(alertMessage).removeClass('alert-danger');
            $(alertMessage).addClass('alert-success');
            $(alertMessage).html('Changes successfully saved. Please restart DayZ server to apply them.');
            $(alertMessage).css('visibility', 'visible');
            $(alertMessage).fadeIn(0).delay(5000).fadeOut(1000);
            console.log('Settings successfully changed.');
        }).fail(function (err) {
            $(alertMessage).removeClass('alert-success');
            $(alertMessage).addClass('alert-danger');
            $(alertMessage).html(err.status == 0 ? 'Service is unreachable. Please check is server running or internet connection.' : 'Internal server error. Failed to save changes.');
            $(alertMessage).css('visibility', 'visible');
            $(alertMessage).fadeIn(0);
            console.error('Failed to change settings.');
        });
    };

    function readPageValues(rootElement) {
        var dataObject = {};
        $(rootElement).find('[mapping]').each(function () {
            var result = null;
            let val = $(this).val();
            if ($(this).is("input")) {
                let type = $(this).attr('type');
                if (type == 'number') {
                    result = parseFloat(val);
                }
                else if (type == 'checkbox') {
                    result = $(this).is(":checked") ? 1 : 0;
                }
                else {
                    result = String(val);
                }
            }
            else if ($(this).is("textarea")) {
                result = val.split('\n').filter(n => n.trim());
            }
            else if ($(this).is("select")) {
                result = parseInt(val);
            }

            let refPath = $(this).attr('mapping');
            let refParts = refPath.split('.');
            var currentObject = dataObject;
            for (var i = 0; i < refParts.length; i++) {
                let part = refParts[i];
                let last = (i == refParts.length - 1);
                if (part.endsWith(']')) {
                    let name = part.substring(0, part.indexOf('['));
                    let index = parseInt(part.substring(part.indexOf('[') + 1, part.length - 1));
                    if (!currentObject[name]) {
                        currentObject[name] = [];
                    }
                    if (last) {
                        currentObject[name][index] = result;
                    }
                    else if (!currentObject[name][index]) {
                        currentObject[name][index] = {};
                    }
                    currentObject = currentObject[name][index];
                }
                else {
                    if (last) {
                        currentObject[part] = result;
                    }
                    else if (!currentObject[part]) {
                        currentObject[part] = {};
                    }
                    currentObject = currentObject[part];
                }
            }
        });
        return dataObject;
    };

    Array.prototype.remove = function (from, to) {
        var rest = this.slice((to || from) + 1 || this.length);
        this.length = from < 0 ? this.length + from : from;
        return this.push.apply(this, rest);
    };
</script>
